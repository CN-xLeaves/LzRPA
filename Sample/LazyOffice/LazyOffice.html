<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<script type="text/javascript" src="../help.js"></script>
<link rel="stylesheet" href="../help.css" type="text/css" />
<title>懒人Office插件</title>
</head>
<body onload='prettyPrint()' class='doc_1'>
<p class='tz_title'>懒人Office插件</p>
<hr>
<table class='help' id='AccAddTBKey'>
<tr><th>命令名称：</th>
<td class='name'><a>AccAddTBKey</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据表增加一个字段</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccAddTBKey(key, tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，按"字段名 类型"的格式设置，如只提供字段名，将默认该字段为字符串型
tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>布尔型，成功返回True，失败返回False</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='smuq'>Import "LazyOffice.dll"

Dim path, DBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Call LazyOffice.AccAddTBKey("字段2","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 char(20)","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 Int","测试表",DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("smuq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccDBClose'>
<tr><th>命令名称：</th>
<td class='name'><a>AccDBClose</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>关闭数据库</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub AccDBClose(idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='he4a'>Import "LazyOffice.dll"

Dim path, DBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Call LazyOffice.AccAddTBKey("字段2","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 char(20)","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 Int","测试表",DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("he4a")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccDBOpen'>
<tr><th>命令名称：</th>
<td class='name'><a>AccDBOpen</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>打开数据库</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccDBOpen(host[, pwd, tpe, user, dbname])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>host：字符串类型，数据库路径或Serve地址
pwd：字符串类型，密码
tpe：字符串类型，数据库类型，暂支持ACCESS和MYSQL，可直接填写ConnectionString测试能否连接数据库。
user：字符串类型，用户名
dbname：字符串类型，数据库名</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，库索引。对于ACCESS,当数据库不存在时将新建。</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='fqzs'>Import "LazyOffice.dll"

Dim path, DBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Call LazyOffice.AccAddTBKey("字段2","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 char(20)","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 Int","测试表",DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("fqzs")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数3支持的关键词包括：
  "ACCESS"、"ACCESS1"、"MYSQL"、"MYSQL1"、"MYSQL2"、"MYSQL3"
  "SQL"、"SQL1"、"SQL Server 2005"、"SQL Server 20051"、"MIMER SQL"
  "ORACLE"、"ORACLE1"、"ORACLE2"、"INTERBASE"、"INTERBASE1"、"INTERBASE2"
  "SYBASE"、"SYBASE1"、"SYBASE2"、"INFORMIX"、"INFORMIX1"
  "DSN"、"DSN1"、"DBF"、"DBF1"、"FOX"、"FOX1"、"PERVASIVE"、"PERVASIVE1"
  除"ACCESS"、"MYSQL"以外，不保证命令能用。
</pre></td>
</tr></table>





<table class='help' id='AccDBRun'>
<tr><th>命令名称：</th>
<td class='name'><a>AccDBRun</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据库执行SQL语句</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccDBRun(sql, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>sql：字符串类型，SQL语句
idx：整型类型，库索引
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，失败返回-1，成功时无对象返回0，有对象返回表索引</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ke6l'>Import "LazyOffice.dll"

Dim path, DBIndex, SqlStr
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
SqlStr="Create TABLE [表名]([字段名1] MEMO NOT NULL, [字段名2] MEMO, [字段名3] COUNTER NOT NULL, [字段名4] DATETIME, [字段名5] TEXT(200))"
Call LazyOffice.AccDBRun(SqlStr,DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ke6l")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccDelTB'>
<tr><th>命令名称：</th>
<td class='name'><a>AccDelTB</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>删除数据表</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccDelTB(tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>布尔型，成功返回True，失败返回False</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='x4et'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Value= LazyOffice.AccListTBs(DBIndex)
if Value(0)>0 then
    '删除最后一个数据表表
    Call LazyOffice.AccDelTB(Value(Value(0)),DBIndex)
end if
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("x4et")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccDelTBKey'>
<tr><th>命令名称：</th>
<td class='name'><a>AccDelTBKey</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据表删除一个字段</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccDelTBKey(key, tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，字段名
tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>布尔型，成功返回True，失败返回False</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='mwxw'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Call LazyOffice.AccDelTBKey("字段1","测试表",DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("mwxw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccessClass'>
<tr><th>命令名称：</th>
<td class='name'><a>AccessClass</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据表删除一个字段</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccessClass()</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>无</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串型</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ph1u'>Import "LazyOffice.dll"

TracePrint LazyOffice.AccessClass()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ph1u")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccGetPwd'>
<tr><th>命令名称：</th>
<td class='name'><a>AccGetPwd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>破解Access数据库密码</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccGetPwd(path)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串类型，Access文件路径
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串类型，密码</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='c58v'>Import "LazyOffice.dll"

Dim path
path = "C:\\测试.mdb"
TracePrint LazyOffice.AccGetPwd(path)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("c58v")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccGetTBKeys'>
<tr><th>命令名称：</th>
<td class='name'><a>AccGetTBKeys</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表所有字段名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccGetTBKeys(tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>数组，各元素存放字段名</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='jlgw'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
DBIndex= LazyOffice.AccDBOpen(path)
Value= LazyOffice.AccGetTBKeys("测试表",DBIndex)
TracePrint join(Value, "\n")
Call LazyOffice.AccDBClose(DBIndex)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("jlgw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>注意：此命令最好在表未打开前使用
返回的字段名不一定按照可见操作时的排序

</pre></td>
</tr></table>





<table class='help' id='AccListTBs'>
<tr><th>命令名称：</th>
<td class='name'><a>AccListTBs</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据库所有表名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccListTBs(idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回数组，第一个元素为数量，其后为各个表名</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='xmqg'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
DBIndex= LazyOffice.AccDBOpen(path)
Value= LazyOffice.AccListTBs(DBIndex)
TracePrint join(Value, "\n")
Call LazyOffice.AccDBClose(DBIndex)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("xmqg")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre></pre></td>
</tr></table>





<table class='help' id='AccRenameTB'>
<tr><th>命令名称：</th>
<td class='name'><a>AccRenameTB</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据表改名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccRenameTB(oldtab, newtab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>oldtab：字符串类型，旧表名
newtab：字符串类型，新表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>布尔型，成功返回True，失败返回False</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='czly'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Value= LazyOffice.AccListTBs(DBIndex)
if Value(0) > 0 then
    '最后一个数据表改名
    Call LazyOffice.AccRenameTB(Value(Value(0)),"测试表",DBIndex)
end if
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("czly")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccSetPwd'>
<tr><th>命令名称：</th>
<td class='name'><a>AccSetPwd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置Access数据库密码</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccSetPwd(oldpwd, newpwd, path)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>oldpwd：字符串类型，原密码
newpwd：字符串类型，新密码
path：字符串类型，Access文件路径</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>布尔型，成功返回True，失败返回False</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='hesr'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
Call LazyOffice.AccSetPwd("123", "456", path)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("hesr")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccSetTBKey'>
<tr><th>命令名称：</th>
<td class='name'><a>AccSetTBKey</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>修改数据表字段名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccSetTBKey(oldkey, newkey, tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>oldkey：字符串类型，旧字段名
newkey：字符串类型，新字段名
tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>成功时如表已打开，返回表索引，如未打开，返回0。失败返回-1</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ud9a'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Call LazyOffice.AccSetTBKey("字段1","测试字段","测试表",DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ud9a")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBAddRecord'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBAddRecord</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据表增加一行数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBAddRecord(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置，失败返回0</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='jetq'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
TracePrint LazyOffice.AccTBAddRecord(TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("jetq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBClose'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBClose</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>关闭数据表 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub AccTBClose(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='nqoc'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
Call LazyOffice.AccTBClose(TBIndex ,DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("nqoc")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBDelRecord'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBDelRecord</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>删除数据表当前行数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBDelRecord(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置，失败返回0</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='s5uc'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
'删除最后一条记录
TracePrint LazyOffice.AccTBMovePosi("LAST",TBIndex, DBIndex)   
TracePrint LazyOffice.AccTBDelRecord(TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("s5uc")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBGetKeys'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetKeys</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表所有字段名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetKeys(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>数组，各元素存放字段名</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='g42d'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
Value = LazyOffice.AccTBGetKeys(TBIndex ,DBIndex)
TracePrint join(Value, "\n")
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("g42d")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>另一个获取数据表所有字段名的命令，打开数据表后操作
返回的字段名按照可见操作时的排序</pre></td>
</tr></table>





<table class='help' id='AccTBGetPosi'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetPosi</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表游标所在位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetPosi(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='uwmg'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
TracePrint LazyOffice.AccTBGetPosi(TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("uwmg")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre></pre></td>
</tr></table>





<table class='help' id='AccTBGetValue'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetValue</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表当前行某字段数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetValue(key, tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，字段名
tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='r8hx'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
TracePrint LazyOffice.AccTBGetValue("字段1",TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("r8hx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre></pre></td>
</tr></table>





<table class='help' id='AccTBGetValueArr'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetValueArr</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表所有内容</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetValueArr(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回下标从1开始的二维数组，该数组可直接用办公插件区域写入的命令写入EXCEL</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='dwwf'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value, Name
Dim Index,i,rmax,cmax,range
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
path="C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'获取所有字段名
Name = LazyOffice.AccTBGetKeys(TBIndex, DBIndex)
'写入字段名
For i = 1 To ubound(Name) + 1
    Call LazyOffice.ExcelWrite(1,1,i,Name(i-1),Index)
Next
'获取所有内容
Value = LazyOffice.AccTBGetValueArr(TBIndex, DBIndex)
'获取需要将内容写入的范围
rmax = ubound(Value, 1) + 1 : cmax = ubound(Value, 2)
range = LazyOffice.LocToAdd(rmax, cmax)
'将内容写入区域
Call LazyOffice.ExcelWriteEX(1, "A2:"&range, Value, Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("dwwf")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBGetValueArrC'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetValueArrC</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表字段下所有数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetValueArrC(key, tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，字段名
tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>数组，各元素存放值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='kv5n'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
'获取字段1下所有内容
Value = LazyOffice.AccTBGetValueArrC("字段1",TBIndex, DBIndex)
TracePrint join(Value, "\n")
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("kv5n")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBGetValueArrR'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetValueArrR</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表当前行所有数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetValueArrR(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，字段名
tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>数组，各元素存放值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='gnfq'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
TracePrint LazyOffice.AccTBGetValueArrR(TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("gnfq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBMovePosi'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBMovePosi</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>移动游标</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBMovePosi(site, tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>site：位置或移动方向，设置整数型行号直接跳转，或者，"First"回到开头,"Last"移至末尾,"Up"上一行,"Down"下一行
tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='dzji'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
TracePrint LazyOffice.AccTBMovePosi("LAST",TBIndex, DBIndex)
TracePrint LazyOffice.AccTBMovePosi(2,TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("dzji")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBOpen'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBOpen</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>打开数据表</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBOpen(tab, idx[, keys, where])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tab：字符串类型，表名
idx：整型类型，库索引
keys：字符串类型，字段集，默认为"*"。表不存在时使用"字段1 类型1,字段2 类型2"的格式新建表。表存在时使用"字段1,字段2"的格式设置执行查询语句后需要返回的字段。
where：字符串类型，查询条件，默认为""。使用"Name='懒人'"等格式，条件中字符串用单引号</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，表索引。当数据表不存在时，将新建</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='b47c'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
// 返回测试表所有记录，相当于执行 SELECT * From [测试表]
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex)
// 按条件返回测试表记录，相当于执行 SELECT 字段1,字段2 From [测试表] Where 字段1>10
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex, "字段1,字段2", "字段1>10")
TBIndex = LazyOffice.AccTBOpen("新测试表",DBIndex,"[编号] COUNTER NOT NULL, [时间] DATETIME, [地点] TEXT(200), [备注] MEMO")
Call LazyOffice.AccDBClose(DBIndex)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("b47c")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数3设置需要返回的字段集，多个字段名使用","隔开。默认为"",返回所有字段。如果设置的字段集中某个字段不存在，将忽略该字段。本参数也可自行设置查询语句，参数4将不起作用。
参数4设置查询条件，默认为""，不使用条件。
</pre></td>
</tr></table>





<table class='help' id='AccTBRecordCount'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBRecordCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表总记录数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBRecordCount(tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，总记录数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='o3pd'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
TracePrint LazyOffice.AccTBRecordCount(TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("o3pd")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBSetValue'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBSetValue</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>修改数据表当前行某字段数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBSetValue(key, value, tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，字段名
value：可变型，值
tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置，失败返回0</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='reht'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
TracePrint LazyOffice.AccTBSetValue("字段1","测试内容",TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("reht")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre></pre></td>
</tr></table>





<table class='help' id='AccTBSetValueArrR'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBSetValueArrR</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>修改数据表当前行所有数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBSetValueArrR(valuearr, tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>valuearr：值数组
tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置，失败返回0</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='hh3e'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Arr
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
Arr = array("",2,3,4,5,6)
TracePrint LazyOffice.AccTBSetValueArrR(Arr,TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("hh3e")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>数据格式需要与字段格式一致，否则写入不成功。为避免自动编号等字段不能写入造成命令不可用，数组中设为""的元素填写时将被忽略。</pre></td>
</tr></table>





<table class='help' id='AddToLoc'>
<tr><th>命令名称：</th>
<td class='name'><a>AddToLoc</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>单元格名称转坐标</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AddToLoc(arg, row, column)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>arg：字符串，单元格名称，如：“A1”
row：用来存放返回的行号
column：用来存放返回的列号</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，“行号,列号”格式的字符串</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='tv9e'>Import "LazyOffice.dll"

Dim str, H, L
str= LazyOffice.AddToLoc("B3",H,L) //B3单元格
TracePrint str, H, L</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("tv9e")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre></pre></td>
</tr></table>





<table class='help' id='CallFunction '>
<tr><th>命令名称：</th>
<td class='name'><a>CallFunction </a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>执行EXCEL函数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function CallFunction(idx, tpe, funname[, function1, function2 ...])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，设为0时可以用来调用函数功能而不需要打开表格。
tpe：整数型，函数类型,只能为1、2、4、8。有返回值的函数一般设为2
funname：字符串，函数名称
function1：函数参数1
function2：函数参数2
...</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>根据函数类型决定是否有返回值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='aurn'>Import "LazyOffice.dll"

Dim path, Index, Rang, Value, Arr
path = "C:\\测试.xls"
Arr = Array(1,2,3,5,7,9)
TracePrint LazyOffice.CallFunction(0, 2, "SUM", Arr)
TracePrint LazyOffice.CallFunction(0, 2, "SUM", 1, 10, 100)
Index = LazyOffice.ExcelOpen(path, 1)
Rang = LazyOffice.ObjRange(1, "A1:A4", index)
TracePrint LazyOffice.CallFunction(index, 2, "SUM", Rang)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("aurn")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>使用CallFunction命令时需注意：
        参数1用来设置调用函数的表格，即使用表格索引。设为0时可在不提前打开表格的情况下调用需要的函数，涉及到表格数据时请不要使用0代替，否则可能出现预料之外的错误返回值。
        参数2设置调用函数的类型，只能为1、2、4、8。具体使用哪个数值请自行测试，例如有返回值可设为2。
        参数3设置函数名称，具体可使用的函数及用法请查看官方在EXCEL帮助中关于函数的说明。
        从参数4开始，后面均用来设置函数参数，最多支持20个参数。参数中涉及到区域的，需要使用ObjRange命令进行处理。
    由于CallFunction命令调用内置函数时，区域不能直接使用"A1:E5"之类的形式，因此需要使用ObjRange命令先进行处理再调用。参数1设置标签页，为0时返回工作簿对象。参数2设置区域范围，为""时返回工作表对象。参数3设置索引值。</pre></td>
</tr></table>





<table class='help' id='ExcelBindByName '>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelBindByName </a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL文件已打开的情况下，通过文件名绑定EXCEL，不需要知道完整路径</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelBindByName(filename)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>filename：字符串，EXCEL文件名</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，索引值，本插件对多个EXCEL进行操作时需要。文件名不存在则返回空""</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='pm1p'>Import "LazyOffice.dll"

Dim index, path
index = LazyOffice.ExcelBindByName("测试.xlsx")
If index <> "" Then 
    path= LazyOffice.ExcelPath(index)
    MsgBox "索引值：" & index & "\n文件路径：" & path    
End If</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("pm1p")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelCells'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelCells</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL全表操作</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelCells(tag, parm1, parm2, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，标签索引号或者字符串型旧的标签名称
parm1：字符串，操作对象
parm2：字符串，操作内容
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>所有可以设置的操作对象，均可尝试将值设为空字符串（""）以获取状态返回值
操作对象为"精确查找”或"模糊查找”时返回数组，第一个元素为找到的个数，其后为位置 </pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='szwi'>Import "LazyOffice.dll"

Dim index = LazyOffice.ExcelOpen("c:\\test.xls",1)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("szwi")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数2和参数3对应选项：
"水平对齐"："靠左"，"居中"，"靠右" 
"垂直对齐"："靠上"，"居中"，"靠下" 
"字形" "加粗"，"倾斜"， "加粗 倾斜" 
"复制"  不填或者填-1的话只复制 填大于0的正整数复制到对应标签页，填其他或者不填的话增加新标签页 
"字号"：整数型数值
"行高"：数值,设为小于0的负数则为自动设置
"精确查找"：字符串型需要查找的内容
"列宽"：数值,设为小于0的负数则为自动设置
"缩小字体填充"：不填或填True为缩小，False为取消
"字体"：系统字体，字符串型，如"隶书"，"宋体"
"自动换行"：不填或填True为自动换行，False为取消
"合并单元格"：填True为合并，False为拆分，填""时获取设定区域所在的合并单元格范围
"清除"："格式","批注","全部",填其他默认只清除内容
"字体颜色"：1至56的整数型数值或16进制RGB颜色，具体对应关系可通过运行ExcelOpen命令中的脚本例子进行查看，设为0表示使用自动配色
"背景颜色"：1至56的整数型数值或16进制RGB颜色，具体对应关系可通过运行ExcelOpen命令中的脚本例子进行查看，设为0表示无填充颜色
"格式"：本参数格式为"[格式],[格式代码],[中文类型]"，具体填法参照EXCEL单元格格式设置中的数字设置，如："常规"，"常规,中文小写"，"文本"，"数值,#,##0.000;-#,##0.00"，"数值,￥#,##0.000;-#,##0.00,中文大写"，"数值,yyyy年m月d日"
"打印"：ExcelCells命令中可直接设置为打印份数,或按照"打印份数,打印起始页-打印终止页,打印机名称"的格式设置，如"2,3-5"表示将第3到第5页打印2份，其他EXCEL操作命令中直接设置打印份数或按照"打印份数,打印机名称"的格式设置
"模糊查找"：字符串型需要查找的内容
"删除线"：不填或填True为缩小，False为取消
"插入"：区域操作中操作内容参数可设为"右"、"下"、"行"、"列"表示插入方式。行列操作中，操作内容参数设为0插入复制行列，设为大于0的整数插入相应数量的空行，设为其他插入一行</pre></td>
</tr></table>





<table class='help' id='ExcelCharColor'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelCharColor</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置单元格内某字符串颜色</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelCharColor(tag, arg, start, lenght, color[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
arg：字符串，单元格名称，如"A1”
statr：整数型，字符起始位置
lenght：整数型，字符长度
color：字符串，颜色值，1-56整数值，或者16进制颜色值，设为-1或""时获取指定字符颜色
idx：整数型，索引值 ，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='dk9t'>Import "LazyOffice.dll"

Dim index = LazyOffice.ExcelOpen("c:\\test.xls",0)
Call LazyOffice.ExcelWrite(1, 2, 2, "懒人插件命令测试", index)
Call LazyOffice.ExcelCharColor(1, "A1", 1, Len("懒人插件命令测试"), "FFF000", index)
Call LazyOffice.ExcelClose()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("dk9t")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelClass'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelClass</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>返回该组命令所在类名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelClass()</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>无</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，返回类名的名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='qjio'>Import "LazyOffice.dll"

TracePrint LazyOffice.ExcelClass()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("qjio")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelClose'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelClose</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>关闭EXCEL文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelClose(idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='gkbx'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.ExcelOpen("c:\test.xls",0)
Call LazyOffice.ExcelWrite(1, 2, 2, "懒人插件命令测试", index)
Call LazyOffice.ExcelCharColor(1, "B2", 1, Len("懒人插件命令测试"), "FF00FF", index)
Call LazyOffice.ExcelClose(index)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("gkbx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelColumns'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelColumns</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL列操作</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelColumns(tag, rang, parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，整数型的标签索引号或者字符串型旧的标签名称
rang：操作范围
parm1：操作对象，可填的项目包括 "水平对齐"，"垂直对齐"，"自动换行"，"缩小字体填充"，"合并单元格"，"拆分单元格"，"字体"，"字形"，"字号" ，
"字体颜色"， "背景颜色"， "行高" ， "列宽" ， "删除线"，"清除"， "删除"， "插入"，"隐藏”，"精确查找" ，"模糊查找" ，"复制" ，"格式"
parm2：操作内容
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>所有可以设置的操作对象，均可尝试将值设为空字符串（""）以获取状态返回值
操作对象为"精确查找”或"模糊查找”时返回数组，第一个元素为找到的个数，其后为行号</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='jn6q'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
// 设置文本对齐方式，参数4可设置为"靠左"、"靠右"、"居中"
// 参数4设为""时获取设置值，返回值：靠左：-4131；靠右：-4152；居中：-4108；靠上：-4160；靠下：-4107
Call LazyOffice.ExcelRows(1,1,"水平对齐","靠右",Index)
Call LazyOffice.ExcelRows(1,1,"垂直对齐","靠上",Index)
TracePrint LazyOffice.ExcelRows(1,1,"垂直对齐","",Index)

// 设置自动换行，参数4设为布尔型，True或False。设为""时获取区域设置
Call LazyOffice.ExcelRows(1,1,"自动换行",True,Index)
TracePrint LazyOffice.ExcelRows(1,1,"自动换行","",Index)

// 设置缩小字体填充，参数4设为布尔型，True或False。设为""时获取区域设置
Call LazyOffice.ExcelRows(1,1,"缩小字体填充",True,Index)
TracePrint LazyOffice.ExcelRows(1,1,"缩小字体填充","",Index)

// 合并单元格，参数4设为布尔型，True或False。设为""时获取区域设置
Call LazyOffice.ExcelRows(1,"1:3","合并单元格",True,Index)
TracePrint LazyOffice.ExcelRows(1,1,"合并单元格","",Index)
Call LazyOffice.ExcelRows(1,"1:3","合并单元格",False,Index)

// 设置字体，参数4设为字符串型，设为""时获取区域设置
Call LazyOffice.ExcelRows(1,1,"字体","隶书",Index)
TracePrint LazyOffice.ExcelRows(1,1,"字体","",Index)

// 设置字形，参数4设为字符串型，所设置的字形可以是"常规"、"加粗"、"倾斜"、"加粗 倾斜"。设为""时获取区域设置。
Call LazyOffice.ExcelRows(1,1,"字形","加粗 倾斜",Index)
TracePrint LazyOffice.ExcelRows(1,1,"字形","",Index)

// 设置字号，参数4设置单元格字号
Call LazyOffice.ExcelRows(1,1,"字号",15,Index)
TracePrint LazyOffice.ExcelRows(1,1,"字号","",Index)

// 设置字体颜色，参数4设为整型颜色值或者16进制RGB颜色。设为""时获取区域16进制RGB颜色。
Call LazyOffice.ExcelRows(1,1,"字体颜色",3,Index)
TracePrint LazyOffice.ExcelRows(1,1,"字体颜色","",Index)

// 设置背景颜色，参数4设为整型颜色值或者16进制RGB颜色。设为""时获取区域16进制RGB颜色。
Call LazyOffice.ExcelRows(1,1,"背景颜色",6,Index)
TracePrint LazyOffice.ExcelRows(1,1,"背景颜色","",Index)

// 设置行高，参数4设为整型数值。设为负数时自动调节行高，设为""时获取区域设置。
Call LazyOffice.ExcelRows(1,1,"行高",40,Index)
TracePrint LazyOffice.ExcelRows(1,1,"行高","",Index)

// 设置列宽，参数4设为整型数值。设为负数时自动调节列宽，设为""时获取区域设置。
Call LazyOffice.ExcelRows(1,1,"列宽",10,Index)
TracePrint LazyOffice.ExcelRows(1,1,"列宽","",Index)

// 设置下划线，参数4设为整型数值，用来指定下划线类型。设为""时获取区域设置，返回整型数值。
// 无下划线：-4142
// 单下划线：2
// 双下划线：-4119
// 会计用单下划线：4
// 会计用双下划线：5
Call LazyOffice.ExcelRows(1,1,"下划线",2,Index)
TracePrint LazyOffice.ExcelRows(1,1,"下划线","",Index)

// 设置删除线，参数4设为布尔型，True或False。设为""时获取区域设置
Call LazyOffice.ExcelRows(1,1,"删除线",True,Index)
TracePrint LazyOffice.ExcelRows(1,1,"删除线","",Index)

// 设置单元格格式，参数4包括"常规"、"常规中文小写"、"常规中文大写"、"文本"、"数值"、"数值中文小写"、"数值中文大写"
Call LazyOffice.ExcelRows(1,1,"格式","文本",Index)
TracePrint LazyOffice.ExcelRows(1,1,"格式","",Index)

// 设置隐藏，参数4设为布尔型，True或False。设为""时获取行是否隐藏
Call LazyOffice.ExcelColumns(1,1,"隐藏",True,Index)
TracePrint LazyOffice.ExcelColumns(1,1,"隐藏","",Index)
TracePrint LazyOffice.ExcelColumns(1,1,"隐藏",False,Index)

// 设置插入
// 参数4设为字符串型，可设为"右"、"下"、"行"、"列"，分别表示原区域右移、下移或者插入整行、整列。
// 参数4设为整型数值，当设为正整数时作为在指定列前执行插入的次数（不一定是新插入的列数），设为0时插入复制列。
'第6列前插入2列 
Call LazyOffice.ExcelColumns(1, 6, "插入", 2, Index)
'第3列前插入4列
Call LazyOffice.ExcelColumns(1, "C:D", "插入", 2, Index)
'复制第2列插入第8列
Call LazyOffice.ExcelColumns(1, 2, "复制", 0, Index)
Call LazyOffice.ExcelColumns(1, 8, "插入", 0, Index)

// 设置清除，参数4设为字符串型。可设为"格式"、"批注"、"全部"或者其他字符串，设为上述三个关键词以外的字符串时清除单元格内容
Call LazyOffice.ExcelRows(1,1,"清除","全部",Index)

// 设置删除
Call LazyOffice.ExcelRows(1,1,"删除","",Index)

// 设置删除，参数4直接设置打印份数或按照"打印份数,打印机名称"的格式设置
Call LazyOffice.ExcelRows(1,"1:20","打印",2,Index)

Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("jn6q")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelCopyTo'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelCopyTo</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL数据复制至</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelCopyTo(SurTag, SurRang, DstTag, DstRang, Tpe)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>SurTag：整数型，来源标签页，整数型的标签索引号或者字符串型旧的标签名称,为0时仅粘贴
SurRang：字符串，复制区域，格式为"区域,EXCEL索引号”，区域为""时整表复制
DstTag：整数型，去向标签页，整数型的标签索引号或者字符串型旧的标签名称,为0时仅粘贴
DstRang：字符串，粘贴区域，格式为同复制区域,默认为"A1:A1”，区域为""时整表粘贴
Tpe：整数型，复制方式，默认普通复制,填1相当于格式刷,2为只复制值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='obcw'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.ExcelOpen("c:\\test.xls", 0)
Call LazyOffice.ExcelWrite(1, 2, 2, "懒人插件命令测试", index)
Call LazyOffice.ExcelCopyTo(1, "", 2, "", 1)
Call LazyOffice.ExcelClose()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("obcw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelFilter'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelFilter</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>筛选工作表</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelFilter(tag, title, column, filter[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，工作表第几页或标签名
title：整数型，标题行，每次使用ExcelFilterOver命令结束筛选之前此参数只有第一次设置的有效
column：整数型，需要筛选的列
filter：字符串，筛选条件 ，直接设置值，或者使用"<=6 and >0”及"=按??灵 or =懒人*”的格式
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回数组，第一个元素为筛选结果的总行数，其后为对应的行号 </pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='c1kr'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.ExcelOpen("c:\\test.xls", 0)
Call LazyOffice.ExcelFilter(1, 1, 2, ">=5", index)
Call LazyOffice.ExcelFilterOver(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("c1kr")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelFilterData'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelFilterData</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取筛选工作表时下拉框中的数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelFilterData(tag, column[, rang, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，工作表第几页或标签名
column：整数型，列，整数型数值表示是第几列，或者直接使用列名称
rang：字符串，行号范围，格式如"3:7”，留空""则获取整列数据
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回数组，第一个元素为个数，其后为获取的内容 </pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='kslb'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.ExcelOpen("c:\\test.xls", 0)
Call LazyOffice.ExcelFilterDatar(1, 1, "", index)
Call LazyOffice.ExcelFilterOver(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("kslb")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelFilterOver'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelFilterOver</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>结束筛选工作表 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelFilterOver(tag, [, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，工作表第几页或标签名
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='hvgm'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.ExcelOpen("c:\\test.xls", 0)
Call LazyOffice.ExcelFilterDatar(1, 1, "", index)
Call LazyOffice.ExcelFilterOver(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("hvgm")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelGetPwd'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelGetPwd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>暴力破解EXCEL密码</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelGetPwd(path[, dict, tpe])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串，文件路径
dict：字典，默认为0，只检索数字。也可设为下列值：
1：检索数字+小写字母
2：检索数字+大小写字母
3：检索数字+字母+符号
或者自定义字典字符串，如"123asd",将只从设定字符中检索密码
tpe：布尔型，是否破解打开和修改权限密码，默认为True，填False将只获取打开密码</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回一个装载2个元素的数组，分别为打开权限密码和修改权限密码
若获取到的密码与设置密码不同，不要怀疑，先试试再说。</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='mjmg'>Import "LazyOffice.dll"

Dim path, sTime1, Pwd
path= "c:\\1.xls"
LazyOffice.ExcelOpen path,0
LazyOffice.ExcelProtect "打开","123"
LazyOffice.ExcelProtect "修改", "456"
LazyOffice.ExcelClose 
MsgBox "已在C盘创建了一个EXCEL表格，打开权限密码为123，修改权限密码为456。请检查。"
Pwd = LazyOffice.ExcelGetPwd(path, 0)
MsgBox "通过暴力破解得到密码为：\n" & join(Pwd, "\n")</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("mjmg")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelHideWindow'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelHideWindow</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>显示、隐藏EXCEL编辑窗口</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelHideWindow(isShow[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>isShow：布尔型，False或0表示隐藏 ，True或其他表示显示
idx：整数型，索引值 ，如果只用本插件打开了一个EXCEL，则可以留空，直接获取EXCEL窗口的句柄
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='zidu'>Import "LazyOffice.dll"

Dim path
path= "c:\\1.xls"
Call LazyOffice.ExcelOpen(path, 1)
Delay 1000
Call LazyOffice.ExcelHideWindow(true)
Delay 1000
Call LazyOffice.ExcelHideWindow(false)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("zidu")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelHwnd'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelHwnd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL窗口句柄</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelHwnd([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空，直接获取EXCEL窗口的句柄</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>该索引号对应的EXCEL的窗口句柄

</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='vjnx'>Import "LazyOffice.dll"

Dim path
path= "c:\\test.xls"
Call LazyOffice.ExcelOpen(path, 1)
Delay 1000
TracePrint LazyOffice.ExcelHwnd()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("vjnx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroCount'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取宏模块总数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelMacroCount([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，模块总数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ld8i'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
TracePrint LazyOffice.ExcelMacroCount(Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ld8i")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroGetName'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroGetName</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取宏模块名称或者索引值 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelMacroGetName(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>宏模块索引值或名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='q1fi'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
TracePrint LazyOffice.ExcelMacroGetName("模块1",Index)
TracePrint LazyOffice.ExcelMacroGetName(1,Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("q1fi")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroRead'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取宏模块</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelMacroRead(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，模块内容</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='xhed'>Import "LazyOffice.dll"

Dim path,Index, MacroStr
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
TracePrint LazyOffice.ExcelMacroRead("模块1", Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("xhed")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroRemove'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroRemove</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>删除宏模块</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelMacroRemove(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='zrgb'>Import "LazyOffice.dll"

Dim path,Index, MacroStr
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
Call LazyOffice.ExcelMacroRemove("模块1", Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("zrgb")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroRun'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroRun</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>执行宏命令</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelMacroRun(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='w4bs'>Import "LazyOffice.dll"
 
Dim path, index, MacroIndex, str
path="c:\1.xls"
str="Range(""A1"").FormulaR1C1 = ""测试""" & "\n" & _
    "Range(""A1"").Interior.ColorIndex = 6" & "\n" & _
    "Range(""A1"").Font.ColorIndex = 3"
index = LazyOffice.ExcelOpen(path, 1)
MsgBox "准备写入宏"    
MacroIndex = LazyOffice.ExcelMacroWrite("TEST", str)
MsgBox "已写入"
Call LazyOffice.ExcelMacroRun("TEST")
MsgBox "已执行"
call LazyOffice.ExcelMacroRemove (MacroIndex )</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("w4bs")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写入宏命令</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelMacroWrite(CmdName, MacroCode[, Macro, Idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>CmdName：字符串，命令名
MacroCode：字符串，宏代码
macro：宏模块名称或索引值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>宏代码所在模块名</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='viyf'>Import "LazyOffice.dll"
 
Dim path, index, MacroIndex, str
path="c:\1.xls"
str="Range(""A1"").FormulaR1C1 = ""测试""" & "\n" & _
    "Range(""A1"").Interior.ColorIndex = 6" & "\n" & _
    "Range(""A1"").Font.ColorIndex = 3"
index = LazyOffice.ExcelOpen(path, 1)
MsgBox "准备写入宏"    
MacroIndex = LazyOffice.ExcelMacroWrite("TEST", str)
MsgBox "已写入"
Call LazyOffice.ExcelMacroRun("TEST")
MsgBox "已执行"
call LazyOffice.ExcelMacroRemove (MacroIndex )</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("viyf")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelOpen'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelOpen</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>打开EXCEL文档,若EXCEL已经手动打开，则本命令仅返回操作所需的索引值而不影响表格</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelOpen(path[, tpe, pwd1, pwd2, onlyread])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串，文件路径
tpe：整数型，打开方法，0不可见,1为可见。默认为0
pwd1：打开权限密码，无密码则不需填写
pwd2：修改权限密码，无密码则不需填写
onlyread：整数型，设为1以只读模式打开</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>索引值，本插件对多个EXCEL进行操作时需要。索引值为从1开始计数的正整数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='j8gn'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("j8gn")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPath'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPath</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL完整路径</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPath([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，获取EXCEL完整路径</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='q0qq'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.ExcelPath(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("q0qq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicCount'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>统计某标签页中图片数量 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicCount(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，图片数量</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='bcli'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.ExcelPicCount(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("bcli")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicDel'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>统计某标签页中图片数量 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicDel(tag, picid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
picid：整数型，图片序号，按照图片插入的顺序，最先插入的为1，然后为2，依次类推，序号填0时删除所有图片
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，图片数量</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='zqii'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.ExcelPicCount(1, index)
Call LazyOffice.ExcelPicDel(1, 3, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("zqii")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicInsert'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicInsert</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>插入图片，图片左上角位置为设定的行列值 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicInsert(tag, row, column, pic[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
pic：字符串，图片路径
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，返回插入图片的索引值
用此命令插入的图片，位置跟随设定的单元格变化</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ngzd'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\test.png", index)
TracePrint LazyOffice.ExcelPicCount(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ngzd")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicInsertEX'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicInsertEX</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>选定区域插入图片（自动调节图片大小）</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicInsertEX(tag, leftarg, rightarg, pic[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
leftarg：字符串，图片左上角单元格，格式如"A1"
rightarg：字符串，图片右下角单元格，格式如"A1"
pic：字符串，图片路径
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，返回插入图片的索引值
用此命令插入的图片，位置跟随设定的单元格变化</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='v8_f'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\test.png", index)
Call LazyOffice.ExcelPicInsertEX(1, "A2", "B3", "c:\\test.png", index)
TracePrint LazyOffice.ExcelPicCount(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("v8_f")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicLinkRead'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicLinkRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读图片超链接地址</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicLinkRead(tag, pic[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
pic：字符串，图片路径
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，返回插入图片的索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='sbvq'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
picid = LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\test.png", index)
TracePrint LazyOffice.ExcelPicLinkRead(1, picid, index)
TracePrint LazyOffice.ExcelPicCount(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("sbvq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicLinkWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicLinkWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>为图片设置超链接 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicLinkWrite(tag, picid, link[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
picid：整数型，图片索引值
link：字符串，链接地址
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，返回插入图片的索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='e8aw'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
picid = LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\test.bmp", index)
TracePrint LazyOffice.ExcelPicLinkWrite(1, picid, "http://bbs.anjian.com", index)
TracePrint LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("e8aw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicRotate'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicRotate</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>旋转图片</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicRotate(tag, picid, angle[, isrotation, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
picid：整数型，图片索引值
angle：整数型，角度，-360到360的数值
isrotation：布尔值，是否直接设置图片角度，默认为True设置图片角度，填False则按照参数3设置的角度旋转图片，正数为顺时针，负数为逆时针
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，返回插入图片的索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ko9y'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
picid = LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\yzm.bmp", index)
TracePrint LazyOffice.ExcelPicRotate(1, picid, 90, true, index)
TracePrint LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ko9y")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicSave'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicSave</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保存图片</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelPicSave(tag, picid, path[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
picid：整数型，图片索引值
path：字符串，保存路径
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='sgtc'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
picid = LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\yzm.bmp", index)
Call LazyOffice.ExcelPicSave(1, picid, "c:\\22.bmp", index)
TracePrint LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("sgtc")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicSelected'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicSelected</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取当前选中的图片索引值 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicSelected(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
picid：整数型，图片索引值
path：字符串，保存路径
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>未选中时返回0，选中单个图片返回索引值，选中多个返回各图片索引值，用英文逗号隔开</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='pjem'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
picid = LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\yzm.bmp", index)
TracePrint LazyOffice.ExcelPicSelected(1, index)
TracePrint LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("pjem")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelProtect'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelProtect</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置EXCEL文档密码 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelProtect(tpe, pwd[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tpe：字符串，设置的密码类型，可设置"打开"或"修改"
pwd：字符串，设置的密码
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='u7ln'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
TracePrint LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("u7ln")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelRange'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelRange</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL区域操作 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelRange(tag, rang, parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，整数型的标签索引号或者字符串型旧的标签名称
rang：字符串，操作范围
parm1：字符串，操作对象，可填的项目包括 "水平对齐"，"垂直对齐"，"自动换行"，"缩小字体填充"，"合并单元格"，"拆分单元格"，"字体"，"字形"，"字号" ，
"字体颜色"， "背景颜色"， "行高" ， "列宽" ，"删除线"， "清除"，"打印"， "插入"，"精确查找" ，"模糊查找" ，"复制" ，"格式" 
parm2：字符串，操作内容，对应不同的操作对象，本处可填写的内容各不相同，详见ExcelCells命令中的参数对照表。为空时返回单元格对应参数3的格式信息
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>所有可以设置的操作对象，均可尝试将值设为空字符串（""）以获取状态返回值
操作对象为"精确查找”或"模糊查找”时返回数组，第一个元素为找到的个数，其后为位置 

</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='p62u'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("p62u")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelRead'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取单元格内容</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelRead (tag, row, column[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，单元格内容</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='excx'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'向（3,2）单元格（即"B3"）写入内容
Call LazyOffice.ExcelWrite(1,3,2,"内容",Index)
'读取（3,2）单元格（即"B3"）内容
TracePrint LazyOffice.ExcelRead(1,3,2,Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("excx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReadComment'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReadComment</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取单元格批注</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelReadComment(tag, row, column[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，单元格批注</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='b_7p'>Import "LazyOffice.dll"

Dim path,Index, MacroStr, FontName,FontStyle,FontSize,FontColor,BgColor
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'向（3,2）单元格（即"B3"）写入一个批注
Call LazyOffice.ExcelWriteComment(1, 3, 2, "这是测试一个批注", False, Index)
'设置批注格式
Call LazyOffice.ExcelSetComment(1,3,2,"隶书","加粗",13,8,1,True,False,Index)
'获取批注设置,其中颜色参数若设置为""，可用来获取字符串型16进制RGB颜色；设置为-1，可获取整型颜色数值
FontColor=-1
Call LazyOffice.ExcelSetComment(1,3,2,FontName,FontStyle,FontSize,FontColor,BgColor,True,False,Index)
TracePrint  "字体：" & FontName & "\n" & "字形：" & FontStyle & "\n" & "字号：" & FontSize & "\n" & "字体颜色值：" & FontColor & "\n" & "背景颜色：" & BgColor
'读取（3,2）单元格（即"B3"）批注内容
TracePrint LazyOffice.ExcelReadComment(1,3,2,Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("b_7p")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReadEX'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReadEX</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取单元格文本</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelReadEX(tag, rang[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
rang：字符串，区域范围，如"A2:D6",表示从A2单元格到D6单元格的区域
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回二维数组，分别存放各单元格的内容，如 返回值(1,2)表示第一行第二列数据</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='gyeq'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'向（3,3）单元格（即"C3"）写入数值
Call LazyOffice.ExcelWrite(1, 3, 3, 123456, Index)
'将单元格设置为中文大写格式
Call LazyOffice.ExcelRange(1,"A1:D5","格式","常规中文大写",Index)
'读取（3,3）单元格（即"C3"）显示的内容而不是实际数值
TracePrint LazyOffice.ExcelReadText(1,3,3,Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("gyeq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReadFormula'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReadFormula</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取单元格公式</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelReadFormula(tag, row, column[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>单元格公式，字符串型，无公式则返回单元格内容</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='nemk'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'向（3,2）单元格（即"B3"）写入内容
Call LazyOffice.ExcelWrite(1,3,2,3,Index)
'向（3,3）单元格（即"C3"）写入公式
Call LazyOffice.ExcelWrite(1,3,3,"=B3+5",Index)
'读取（3,3）单元格（即"C3"）值
TracePrint LazyOffice.ExcelRead(1,3,3,Index)
'读取（3,3）单元格（即"C3"）公式
TracePrint LazyOffice.ExcelReadFormula(1,3,3,Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("nemk")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReadLink'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReadLink</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取超级链接 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelReadLink(tag, row, column[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，超级链接</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='jf6b'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'向（4,2）单元格（即"B4"）写入一个超链接
Call LazyOffice.ExcelWriteLink(1, 4, 2, "http://bbs.anjian.com", "这是测试一个超链接", Index)
'当参数5为""时，将使用链接地址作为名称
Call LazyOffice.ExcelWriteLink(1, 5, 2, "http://bbs.anjian.com", "", Index)
'如果单元格已经有内容，参数5为""时链接名称将为原内容
Call LazyOffice.ExcelWriteLink(1, 3, 2, "http://bbs.anjian.com", "", Index)
MsgBox "已分别在B3，B4，B5写入超级链接"
'参数4设置为""时将清除超级链接，但名称不会清除，且参数5无用
Call LazyOffice.ExcelWriteLink(1, 4, 2, "", "这是清除一个超链接", Index)
'读取（3,2）单元格（即"B3"）超链接
TracePrint LazyOffice.ExcelReadLink(1, 3, 2, Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("jf6b")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReadText'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReadText</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取单元格文本</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelReadText(tag, row, column[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，单元格内容</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='fr0s'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'向（3,3）单元格（即"C3"）写入数值
Call LazyOffice.ExcelWrite(1, 3, 3, 123456, Index)
'将单元格设置为中文大写格式
Call LazyOffice.ExcelRange(1,"A1:D5","格式","常规中文大写",Index)
'读取（3,3）单元格（即"C3"）显示的内容而不是实际数值
TracePrint LazyOffice.ExcelReadText(1,3,3,Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("fr0s")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReplace'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReplace</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取超级链接 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelReplace(tag, sur, dst[, rang, match, cap, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
sur：字符串，原内容
dst：字符串，新内容
rang：字符串，操作范围。默认为""，在整个标签页查找替换，也可设为"A1:D10","A:B","2:5"等格式
match：是否单元格匹配，默认为True
cap：是否区分大小写，默认为False
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='e6xm'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelReplace(1, "原内容", "替换内容")
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("e6xm")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelRestore'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelRestore</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>还原上次手动操作</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelRestore([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ecma'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelRestore(index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ecma")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelRows'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelRows</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL行操作</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelRows(tag, rang, parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，整数型的标签索引号或者字符串型旧的标签名称
rang：操作范围
parm1：操作对象，可填的项目包括 "水平对齐"，"垂直对齐"，"自动换行"，"缩小字体填充"，"合并单元格"，"拆分单元格"，"字体"，"字形"，"字号" ，
"字体颜色"， "背景颜色"， "行高" ， "列宽" ， "删除线"，"清除"， "删除"， "插入"，"隐藏”，"精确查找" ，"模糊查找" ，"复制" ，"格式"
parm2：操作内容
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>所有可以设置的操作对象，均可尝试将值设为空字符串（""）以获取状态返回值
操作对象为"精确查找”或"模糊查找”时返回数组，第一个元素为找到的个数，其后为列号</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='yefj'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
// 设置文本对齐方式，参数4可设置为"靠左"、"靠右"、"居中"
// 参数4设为""时获取设置值，返回值：靠左：-4131；靠右：-4152；居中：-4108；靠上：-4160；靠下：-4107
Call LazyOffice.ExcelRows(1,1,"水平对齐","靠右",Index)
Call LazyOffice.ExcelRows(1,1,"垂直对齐","靠上",Index)
TracePrint LazyOffice.ExcelRows(1,1,"垂直对齐","",Index)

// 设置自动换行，参数4设为布尔型，True或False。设为""时获取区域设置
Call LazyOffice.ExcelRows(1,1,"自动换行",True,Index)
TracePrint LazyOffice.ExcelRows(1,1,"自动换行","",Index)

// 设置缩小字体填充，参数4设为布尔型，True或False。设为""时获取区域设置
Call LazyOffice.ExcelRows(1,1,"缩小字体填充",True,Index)
TracePrint LazyOffice.ExcelRows(1,1,"缩小字体填充","",Index)

// 合并单元格，参数4设为布尔型，True或False。设为""时获取区域设置
Call LazyOffice.ExcelRows(1,"1:3","合并单元格",True,Index)
TracePrint LazyOffice.ExcelRows(1,1,"合并单元格","",Index)
Call LazyOffice.ExcelRows(1,"1:3","合并单元格",False,Index)

// 设置字体，参数4设为字符串型，设为""时获取区域设置
Call LazyOffice.ExcelRows(1,1,"字体","隶书",Index)
TracePrint LazyOffice.ExcelRows(1,1,"字体","",Index)

// 设置字形，参数4设为字符串型，所设置的字形可以是"常规"、"加粗"、"倾斜"、"加粗 倾斜"。设为""时获取区域设置。
Call LazyOffice.ExcelRows(1,1,"字形","加粗 倾斜",Index)
TracePrint LazyOffice.ExcelRows(1,1,"字形","",Index)

// 设置字号，参数4设置单元格字号
Call LazyOffice.ExcelRows(1,1,"字号",15,Index)
TracePrint LazyOffice.ExcelRows(1,1,"字号","",Index)

// 设置字体颜色，参数4设为整型颜色值或者16进制RGB颜色。设为""时获取区域16进制RGB颜色。
Call LazyOffice.ExcelRows(1,1,"字体颜色",3,Index)
TracePrint LazyOffice.ExcelRows(1,1,"字体颜色","",Index)

// 设置背景颜色，参数4设为整型颜色值或者16进制RGB颜色。设为""时获取区域16进制RGB颜色。
Call LazyOffice.ExcelRows(1,1,"背景颜色",6,Index)
TracePrint LazyOffice.ExcelRows(1,1,"背景颜色","",Index)

// 设置行高，参数4设为整型数值。设为负数时自动调节行高，设为""时获取区域设置。
Call LazyOffice.ExcelRows(1,1,"行高",40,Index)
TracePrint LazyOffice.ExcelRows(1,1,"行高","",Index)

// 设置列宽，参数4设为整型数值。设为负数时自动调节列宽，设为""时获取区域设置。
Call LazyOffice.ExcelRows(1,1,"列宽",10,Index)
TracePrint LazyOffice.ExcelRows(1,1,"列宽","",Index)

// 设置下划线，参数4设为整型数值，用来指定下划线类型。设为""时获取区域设置，返回整型数值。
// 无下划线：-4142
// 单下划线：2
// 双下划线：-4119
// 会计用单下划线：4
// 会计用双下划线：5
Call LazyOffice.ExcelRows(1,1,"下划线",2,Index)
TracePrint LazyOffice.ExcelRows(1,1,"下划线","",Index)

// 设置删除线，参数4设为布尔型，True或False。设为""时获取区域设置
Call LazyOffice.ExcelRows(1,1,"删除线",True,Index)
TracePrint LazyOffice.ExcelRows(1,1,"删除线","",Index)

// 设置单元格格式，参数4包括"常规"、"常规中文小写"、"常规中文大写"、"文本"、"数值"、"数值中文小写"、"数值中文大写"
Call LazyOffice.ExcelRows(1,1,"格式","文本",Index)
TracePrint LazyOffice.ExcelRows(1,1,"格式","",Index)

// 设置隐藏，参数4设为布尔型，True或False。设为""时获取行是否隐藏
Call LazyOffice.ExcelRows(1,1,"隐藏",True,Index)
TracePrint LazyOffice.ExcelRows(1,1,"隐藏","",Index)
TracePrint LazyOffice.ExcelRows(1,1,"隐藏",False,Index)

// 设置插入，参数4设为整型数值，当设为正整数时作为在指定行前执行插入的次数（不一定是新插入的行数），设为0时插入复制行。
'第6行前插入2行 
Call LazyOffice.ExcelRows(1, 6, "插入", 2, Index)
'第3行前插入4行
Call LazyOffice.ExcelRows(1, "3:4", "插入", 2, Index)
'复制第2行插入第8行
Call LazyOffice.ExcelRows(1, 2, "复制", 0, Index)
Call LazyOffice.ExcelRows(1, 8, "插入", 0, Index)

// 设置清除，参数4设为字符串型。可设为"格式"、"批注"、"全部"或者其他字符串，设为上述三个关键词以外的字符串时清除单元格内容
Call LazyOffice.ExcelRows(1,1,"清除","全部",Index)

// 设置删除
Call LazyOffice.ExcelRows(1,1,"删除","",Index)

// 设置删除，参数4直接设置打印份数或按照"打印份数,打印机名称"的格式设置
Call LazyOffice.ExcelRows(1,"1:20","打印",2,Index)

Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("yefj")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelSave'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelSave</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保存EXCEL文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelSave([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='pg0b'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
Call LazyOffice.ExcelWrite(1, 1, 1, "内容", Index)  
Call LazyOffice.ExcelSave(Index)
Call LazyOffice.ExcelSaveAs("c:\\Test.xls",Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("pg0b")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelSaveAs'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelSaveAs</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL文档另存为</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelSaveAs(path[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串，存放路径，后缀可为.xls.xlt.html.htm.mht.mhtml.xml.txt.csv.xlsx.xlsm.xlsb
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='b47u'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
Call LazyOffice.ExcelWrite(1, 1, 1, "内容", Index)  
Call LazyOffice.ExcelSave(Index)
Call LazyOffice.ExcelSaveAs("c:\\Test.xls",Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("b47u")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelSetComment'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelSetComment</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置单元格批注</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelSetComment(tag, row, column[, font, style, size, fontcolor, bkgndcolor, border, comment, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，标签索引号或者字符串型旧的标签名称
row：整数型，行
column：整数型，列
font：字体，可填"宋体"等系统字体名，为""时装载字体设置
style：字形，可填"常规"、"加粗"、"倾斜"、"加粗 倾斜"，为""时装载字形设置
size：字号，-1或""时装载字号设置
fontcolor：字体颜色值，1至56的整数型数值，-1或""时装载颜色设置
bkgndcolor：背景颜色值，1至56的整数型数值，-1或""时装载颜色设置
border：有无边框，True为有，False为无
comment：批注是否可见，True为可见，False为隐藏
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='oufv'>Import "LazyOffice.dll"

Dim path,Index, MacroStr, FontName,FontStyle,FontSize,FontColor,BgColor
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'向（3,2）单元格（即"B3"）写入一个批注
Call LazyOffice.ExcelWriteComment(1, 3, 2, "这是测试一个批注", False, Index)
'设置批注格式
Call LazyOffice.ExcelSetComment(1,3,2,"隶书","加粗",13,8,1,True,False,Index)
'获取批注设置,其中颜色参数若设置为""，可用来获取字符串型16进制RGB颜色；设置为-1，可获取整型颜色数值
FontColor=-1
Call LazyOffice.ExcelSetComment(1,3,2,FontName,FontStyle,FontSize,FontColor,BgColor,True,False,Index)
TracePrint  "字体：" & FontName & "\n" & "字形：" & FontStyle & "\n" & "字号：" & FontSize & "\n" & "字体颜色值：" & FontColor & "\n" & "背景颜色：" & BgColor
'读取（3,2）单元格（即"B3"）批注内容
TracePrint LazyOffice.ExcelReadComment(1,3,2,Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("oufv")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelSort'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelSort</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>选定区域排序 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelSort(tag, rang, column[, column1, column2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表第几页或标签名
rang：操作范围
column：关键列1，格式为"列号,升/降”，如"1,降"表示第1列降序排列，或直接填写列号默认升序
column1：关键列2，格式同关键列1
column2：关键列3，格式同关键列1
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='wlpg'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelSort(1, "", "1,降")
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("wlpg")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写入单元格内容 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelWrite(tag, row, column, str[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
str：字符串，内容
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='bykx'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'向（3,2）单元格（即"B3"）写入内容
Call LazyOffice.ExcelWrite(1,3,2,"内容",Index)
'读取（3,2）单元格（即"B3"）内容
TracePrint LazyOffice.ExcelRead(1,3,2,Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("bykx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelWriteComment'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelWriteComment</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写入单元格批注</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelWriteComment(tag, row, column, comment[,isshow, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
column：字符串，批注内容，设为""时删除批注
isshow：布尔型，批注是否可见，True为可见，False为隐藏
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='mlzx'>Import "LazyOffice.dll"

Dim path,Index, MacroStr, FontName,FontStyle,FontSize,FontColor,BgColor
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'向（3,2）单元格（即"B3"）写入一个批注
Call LazyOffice.ExcelWriteComment(1, 3, 2, "这是测试一个批注", False, Index)
'设置批注格式
Call LazyOffice.ExcelSetComment(1,3,2,"隶书","加粗",13,8,1,True,False,Index)
'获取批注设置,其中颜色参数若设置为""，可用来获取字符串型16进制RGB颜色；设置为-1，可获取整型颜色数值
FontColor=-1
Call LazyOffice.ExcelSetComment(1,3,2,FontName,FontStyle,FontSize,FontColor,BgColor,True,False,Index)
TracePrint  "字体：" & FontName & "\n" & "字形：" & FontStyle & "\n" & "字号：" & FontSize & "\n" & "字体颜色值：" & FontColor & "\n" & "背景颜色：" & BgColor
'读取（3,2）单元格（即"B3"）批注内容
TracePrint LazyOffice.ExcelReadComment(1,3,2,Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("mlzx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelWriteEX'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelWriteEX</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写入区域内容</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelWriteEX(tag, rang, arr[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
rang：字符串，区域范围，如"A2:D6",表示从A2单元格到D6单元格的区域，请确保此区域大于需要写入的二维数组区域
arr：二维数组名，此数组应用ExcelReadEX命令生成后进行赋值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='tb8y'>Import "LazyOffice.dll"

Dim a, b, d, table
a=LazyOffice.ExcelOpen ("C:\\test.xls")
table=LazyOffice.ExcelReadEX(1, "A2:Q1010")
For i = 1 To 1000
    For j = 1 To 16
        table(i, j) = i * j
    Next
Next
b=LazyOffice.ExcelWriteEX(1, "A2:Q1010", table)
d=LazyOffice.ExcelClose() </pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("tb8y")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelWriteLink'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelWriteLink</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写超级链接</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelWriteLink(tag, row, column[, link, linkname, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
link：字符串，超级链接地址，留空则清除超级链接，默认为""
linkname：字符串，超级链接名称
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='icrj'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'向（4,2）单元格（即"B4"）写入一个超链接
Call LazyOffice.ExcelWriteLink(1, 4, 2, "http://bbs.anjian.com", "这是测试一个超链接", Index)
'当参数5为""时，将使用链接地址作为名称
Call LazyOffice.ExcelWriteLink(1, 5, 2, "http://bbs.anjian.com", "", Index)
'如果单元格已经有内容，参数5为""时链接名称将为原内容
Call LazyOffice.ExcelWriteLink(1, 3, 2, "http://bbs.anjian.com", "", Index)
MsgBox "已分别在B3，B4，B5写入超级链接"
'参数4设置为""时将清除超级链接，但名称不会清除，且参数5无用
Call LazyOffice.ExcelWriteLink(1, 4, 2, "", "这是清除一个超链接", Index)
'读取（3,2）单元格（即"B3"）超链接
TracePrint LazyOffice.ExcelReadLink(1, 3, 2, Index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("icrj")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<p class='tz_title'>懒人Office插件</p>
<hr>
<table class='help' id='AccAddTBKey'>
<tr><th>命令名称：</th>
<td class='name'><a>AccAddTBKey</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据表增加一个字段</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccAddTBKey(key, tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，按"字段名 类型"的格式设置，如只提供字段名，将默认该字段为字符串型
tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>布尔型，成功返回True，失败返回False</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='upxs'>Import "LazyOffice.dll"

Dim path, DBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Call LazyOffice.AccAddTBKey("字段2","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 char(20)","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 Int","测试表",DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("upxs")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccDBClose'>
<tr><th>命令名称：</th>
<td class='name'><a>AccDBClose</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>关闭数据库</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub AccDBClose(idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='tvlm'>Import "LazyOffice.dll"

Dim path, DBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Call LazyOffice.AccAddTBKey("字段2","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 char(20)","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 Int","测试表",DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("tvlm")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccDBOpen'>
<tr><th>命令名称：</th>
<td class='name'><a>AccDBOpen</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>打开数据库</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccDBOpen(host[, pwd, tpe, user, dbname])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>host：字符串类型，数据库路径或Serve地址
pwd：字符串类型，密码
tpe：字符串类型，数据库类型，暂支持ACCESS和MYSQL，可直接填写ConnectionString测试能否连接数据库。
user：字符串类型，用户名
dbname：字符串类型，数据库名</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，库索引。对于ACCESS,当数据库不存在时将新建。</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ky7x'>Import "LazyOffice.dll"

Dim path, DBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Call LazyOffice.AccAddTBKey("字段2","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 char(20)","测试表",DBIndex)
Call LazyOffice.AccAddTBKey("字段3 Int","测试表",DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ky7x")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数3支持的关键词包括：
  "ACCESS"、"ACCESS1"、"MYSQL"、"MYSQL1"、"MYSQL2"、"MYSQL3"
  "SQL"、"SQL1"、"SQL Server 2005"、"SQL Server 20051"、"MIMER SQL"
  "ORACLE"、"ORACLE1"、"ORACLE2"、"INTERBASE"、"INTERBASE1"、"INTERBASE2"
  "SYBASE"、"SYBASE1"、"SYBASE2"、"INFORMIX"、"INFORMIX1"
  "DSN"、"DSN1"、"DBF"、"DBF1"、"FOX"、"FOX1"、"PERVASIVE"、"PERVASIVE1"
  除"ACCESS"、"MYSQL"以外，不保证命令能用。
</pre></td>
</tr></table>





<table class='help' id='AccDBRun'>
<tr><th>命令名称：</th>
<td class='name'><a>AccDBRun</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据库执行SQL语句</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccDBRun(sql, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>sql：字符串类型，SQL语句
idx：整型类型，库索引
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，失败返回-1，成功时无对象返回0，有对象返回表索引</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='pmdq'>Import "LazyOffice.dll"

Dim path, DBIndex, SqlStr
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
SqlStr="Create TABLE [表名]([字段名1] MEMO NOT NULL, [字段名2] MEMO, [字段名3] COUNTER NOT NULL, [字段名4] DATETIME, [字段名5] TEXT(200))"
Call LazyOffice.AccDBRun(SqlStr,DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("pmdq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数3支持的关键词包括：
  "ACCESS"、"ACCESS1"、"MYSQL"、"MYSQL1"、"MYSQL2"、"MYSQL3"
  "SQL"、"SQL1"、"SQL Server 2005"、"SQL Server 20051"、"MIMER SQL"
  "ORACLE"、"ORACLE1"、"ORACLE2"、"INTERBASE"、"INTERBASE1"、"INTERBASE2"
  "SYBASE"、"SYBASE1"、"SYBASE2"、"INFORMIX"、"INFORMIX1"
  "DSN"、"DSN1"、"DBF"、"DBF1"、"FOX"、"FOX1"、"PERVASIVE"、"PERVASIVE1"
  除"ACCESS"、"MYSQL"以外，不保证命令能用。
</pre></td>
</tr></table>





<table class='help' id='AccDelTB'>
<tr><th>命令名称：</th>
<td class='name'><a>AccDelTB</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>删除数据表</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccDelTB(tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>布尔型，成功返回True，失败返回False</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ggqd'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Value= LazyOffice.AccListTBs(DBIndex)
if Value(0)>0 then
    '删除最后一个数据表表
    Call LazyOffice.AccDelTB(Value(Value(0)),DBIndex)
end if
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ggqd")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数3支持的关键词包括：
  "ACCESS"、"ACCESS1"、"MYSQL"、"MYSQL1"、"MYSQL2"、"MYSQL3"
  "SQL"、"SQL1"、"SQL Server 2005"、"SQL Server 20051"、"MIMER SQL"
  "ORACLE"、"ORACLE1"、"ORACLE2"、"INTERBASE"、"INTERBASE1"、"INTERBASE2"
  "SYBASE"、"SYBASE1"、"SYBASE2"、"INFORMIX"、"INFORMIX1"
  "DSN"、"DSN1"、"DBF"、"DBF1"、"FOX"、"FOX1"、"PERVASIVE"、"PERVASIVE1"
  除"ACCESS"、"MYSQL"以外，不保证命令能用。
</pre></td>
</tr></table>





<table class='help' id='AccDelTBKey'>
<tr><th>命令名称：</th>
<td class='name'><a>AccDelTBKey</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据表删除一个字段</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccDelTBKey(key, tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，字段名
tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>布尔型，成功返回True，失败返回False</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='chjm'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Call LazyOffice.AccDelTBKey("字段1","测试表",DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("chjm")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccessClass'>
<tr><th>命令名称：</th>
<td class='name'><a>AccessClass</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据表删除一个字段</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccessClass()</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>无</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串型</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='yuee'>Import "LazyOffice.dll"

TracePrint LazyOffice.AccessClass()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("yuee")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccGetPwd'>
<tr><th>命令名称：</th>
<td class='name'><a>AccGetPwd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>破解Access数据库密码</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccGetPwd(path)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串类型，Access文件路径
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串类型，密码</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='srul'>Import "LazyOffice.dll"

Dim path
path = "C:\\测试.mdb"
TracePrint LazyOffice.AccGetPwd(path)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("srul")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccGetTBKeys'>
<tr><th>命令名称：</th>
<td class='name'><a>AccGetTBKeys</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表所有字段名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccGetTBKeys(tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>数组，各元素存放字段名</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='gh2n'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
DBIndex= LazyOffice.AccDBOpen(path)
Value= LazyOffice.AccGetTBKeys("测试表",DBIndex)
TracePrint join(Value, "\n")
Call LazyOffice.AccDBClose(DBIndex)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("gh2n")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>注意：此命令最好在表未打开前使用
返回的字段名不一定按照可见操作时的排序

</pre></td>
</tr></table>





<table class='help' id='AccListTBs'>
<tr><th>命令名称：</th>
<td class='name'><a>AccListTBs</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据库所有表名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccListTBs(idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回数组，第一个元素为数量，其后为各个表名</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='reib'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
DBIndex= LazyOffice.AccDBOpen(path)
Value= LazyOffice.AccListTBs(DBIndex)
TracePrint join(Value, "\n")
Call LazyOffice.AccDBClose(DBIndex)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("reib")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre></pre></td>
</tr></table>





<table class='help' id='AccRenameTB'>
<tr><th>命令名称：</th>
<td class='name'><a>AccRenameTB</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据表改名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccRenameTB(oldtab, newtab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>oldtab：字符串类型，旧表名
newtab：字符串类型，新表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>布尔型，成功返回True，失败返回False</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='c0my'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Value= LazyOffice.AccListTBs(DBIndex)
if Value(0) > 0 then
    '最后一个数据表改名
    Call LazyOffice.AccRenameTB(Value(Value(0)),"测试表",DBIndex)
end if
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("c0my")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccSetPwd'>
<tr><th>命令名称：</th>
<td class='name'><a>AccSetPwd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置Access数据库密码</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccSetPwd(oldpwd, newpwd, path)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>oldpwd：字符串类型，原密码
newpwd：字符串类型，新密码
path：字符串类型，Access文件路径</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>布尔型，成功返回True，失败返回False</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='hfts'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
Call LazyOffice.AccSetPwd("123", "456", path)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("hfts")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccSetTBKey'>
<tr><th>命令名称：</th>
<td class='name'><a>AccSetTBKey</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>修改数据表字段名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccSetTBKey(oldkey, newkey, tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>oldkey：字符串类型，旧字段名
newkey：字符串类型，新字段名
tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>成功时如表已打开，返回表索引，如未打开，返回0。失败返回-1</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='veab'>Import "LazyOffice.dll"

Dim path, DBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
Call LazyOffice.AccSetTBKey("字段1","测试字段","测试表",DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("veab")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBAddRecord'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBAddRecord</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>数据表增加一行数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBAddRecord(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置，失败返回0</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='qp4r'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
TracePrint LazyOffice.AccTBAddRecord(TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("qp4r")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBClose'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBClose</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>关闭数据表 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub AccTBClose(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='u1zj'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
Call LazyOffice.AccTBClose(TBIndex ,DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("u1zj")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBDelRecord'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBDelRecord</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>删除数据表当前行数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBDelRecord(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置，失败返回0</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='dk_n'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
'删除最后一条记录
TracePrint LazyOffice.AccTBMovePosi("LAST",TBIndex, DBIndex)   
TracePrint LazyOffice.AccTBDelRecord(TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("dk_n")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBGetKeys'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetKeys</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表所有字段名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetKeys(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>数组，各元素存放字段名</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='rtrv'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
Value = LazyOffice.AccTBGetKeys(TBIndex ,DBIndex)
TracePrint join(Value, "\n")
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("rtrv")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>另一个获取数据表所有字段名的命令，打开数据表后操作
返回的字段名按照可见操作时的排序</pre></td>
</tr></table>





<table class='help' id='AccTBGetPosi'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetPosi</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表游标所在位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetPosi(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='tulf'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
TracePrint LazyOffice.AccTBGetPosi(TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("tulf")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre></pre></td>
</tr></table>





<table class='help' id='AccTBGetValue'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetValue</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表当前行某字段数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetValue(key, tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，字段名
tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='q7gx'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
TracePrint LazyOffice.AccTBGetValue("字段1",TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("q7gx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre></pre></td>
</tr></table>





<table class='help' id='AccTBGetValueArr'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetValueArr</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表所有内容</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetValueArr(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回下标从1开始的二维数组，该数组可直接用办公插件区域写入的命令写入EXCEL</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='vlmx'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value, Name
Dim Index,i,rmax,cmax,range
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
path="C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
'获取所有字段名
Name = LazyOffice.AccTBGetKeys(TBIndex, DBIndex)
'写入字段名
For i = 1 To ubound(Name) + 1
    Call LazyOffice.ExcelWrite(1,1,i,Name(i-1),Index)
Next
'获取所有内容
Value = LazyOffice.AccTBGetValueArr(TBIndex, DBIndex)
'获取需要将内容写入的范围
rmax = ubound(Value, 1) + 1 : cmax = ubound(Value, 2)
range = LazyOffice.LocToAdd(rmax, cmax)
'将内容写入区域
Call LazyOffice.ExcelWriteEX(1, "A2:"&range, Value, Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("vlmx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBGetValueArrC'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetValueArrC</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表字段下所有数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetValueArrC(key, tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，字段名
tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>数组，各元素存放值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='qu4m'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
'获取字段1下所有内容
Value = LazyOffice.AccTBGetValueArrC("字段1",TBIndex, DBIndex)
TracePrint join(Value, "\n")
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("qu4m")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBGetValueArrR'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBGetValueArrR</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表当前行所有数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBGetValueArrR(tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，字段名
tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>数组，各元素存放值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='v91g'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
TracePrint LazyOffice.AccTBGetValueArrR(TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("v91g")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBMovePosi'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBMovePosi</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>移动游标</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBMovePosi(site, tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>site：位置或移动方向，设置整数型行号直接跳转，或者，"First"回到开头,"Last"移至末尾,"Up"上一行,"Down"下一行
tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='tm6y'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex,"字段1,字段2","字段1>10")
TracePrint LazyOffice.AccTBMovePosi("LAST",TBIndex, DBIndex)
TracePrint LazyOffice.AccTBMovePosi(2,TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("tm6y")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBOpen'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBOpen</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>打开数据表</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBOpen(tab, idx[, keys, where])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tab：字符串类型，表名
idx：整型类型，库索引
keys：字符串类型，字段集，默认为"*"。表不存在时使用"字段1 类型1,字段2 类型2"的格式新建表。表存在时使用"字段1,字段2"的格式设置执行查询语句后需要返回的字段。
where：字符串类型，查询条件，默认为""。使用"Name='懒人'"等格式，条件中字符串用单引号</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，表索引。当数据表不存在时，将新建</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='y03y'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
// 返回测试表所有记录，相当于执行 SELECT * From [测试表]
TBIndex = LazyOffice.AccTBOpen("测试表",DBIndex)
// 按条件返回测试表记录，相当于执行 SELECT 字段1,字段2 From [测试表] Where 字段1>10
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex, "字段1,字段2", "字段1>10")
TBIndex = LazyOffice.AccTBOpen("新测试表",DBIndex,"[编号] COUNTER NOT NULL, [时间] DATETIME, [地点] TEXT(200), [备注] MEMO")
Call LazyOffice.AccDBClose(DBIndex)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("y03y")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数3设置需要返回的字段集，多个字段名使用","隔开。默认为"",返回所有字段。如果设置的字段集中某个字段不存在，将忽略该字段。本参数也可自行设置查询语句，参数4将不起作用。
参数4设置查询条件，默认为""，不使用条件。
</pre></td>
</tr></table>





<table class='help' id='AccTBRecordCount'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBRecordCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取数据表总记录数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBRecordCount(tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，总记录数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='s9uh'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
TracePrint LazyOffice.AccTBRecordCount(TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("s9uh")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='AccTBSetValue'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBSetValue</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>修改数据表当前行某字段数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBSetValue(key, value, tab, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>key：字符串类型，字段名
value：可变型，值
tab：字符串类型，表名
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置，失败返回0</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='oaeq'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Value
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
TracePrint LazyOffice.AccTBSetValue("字段1","测试内容",TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("oaeq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre></pre></td>
</tr></table>





<table class='help' id='AccTBSetValueArrR'>
<tr><th>命令名称：</th>
<td class='name'><a>AccTBSetValueArrR</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>修改数据表当前行所有数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AccTBSetValueArrR(valuearr, tabid, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>valuearr：值数组
tabid：整型类型，表索引
idx：整型类型，库索引</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，当前游标位置，失败返回0</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='swip'>Import "LazyOffice.dll"

Dim path, DBIndex, TBIndex, Arr
path = "C:\\测试.mdb"
DBIndex = LazyOffice.AccDBOpen(path)
TBIndex = LazyOffice.AccTBOpen("测试表", DBIndex)
Arr = array("",2,3,4,5,6)
TracePrint LazyOffice.AccTBSetValueArrR(Arr,TBIndex, DBIndex)
Call LazyOffice.AccDBClose(DBIndex)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("swip")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>数据格式需要与字段格式一致，否则写入不成功。为避免自动编号等字段不能写入造成命令不可用，数组中设为""的元素填写时将被忽略。</pre></td>
</tr></table>





<table class='help' id='AddToLoc'>
<tr><th>命令名称：</th>
<td class='name'><a>AddToLoc</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>单元格名称转坐标</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function AddToLoc(arg, row, column)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>arg：字符串，单元格名称，如：“A1”
row：用来存放返回的行号
column：用来存放返回的列号</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，“行号,列号”格式的字符串</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ifts'>Import "LazyOffice.dll"

Dim str, H, L
str= LazyOffice.AddToLoc("B3",H,L) //B3单元格
TracePrint str, H, L</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ifts")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>字段类型：
COUNTER NOT NULL                  //自动编号
2   : "SmallInt",                 // 整型    
3   : "Int",                      // 长整型    
4   : "Real",                     // 单精度型    
5   : "Float",                    // 双精度型    
6   : "Money",                    // 货币    
7   : "DateTime",                 // 日期时间 
11  : "Bit",                      // 是否 
13  : "TimeStamp", 
17  : "TinyInt",                  // 字节 
72  : "UniqueIdentifier",         // 同步复制 ID 
128 : "Binary", 
129 : "Char", 
130 : "NChar", 
131 : "Decimal",                  // 小数 
133 : "DateTime", 
135 : "SmallDateTime", 
200 : "VarChar", 
201 : "Text", 
202 : "VarChar",                 // 文本 
203 : "MEMO",                    // 备注 
204 : "Binary",                  // 二进制 
205 : "Image"                    // OLE 对象
以下字段为无编码字段（NChar、NVarchar、NText型） 8,128,130,202,203,204,205 
以下字段为按当前系统内码编码的字段   129,200,201
</pre></td>
</tr></table>





<table class='help' id='CallFunction '>
<tr><th>命令名称：</th>
<td class='name'><a>CallFunction </a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>执行EXCEL函数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function CallFunction(idx, tpe, funname[, function1, function2 ...])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，设为0时可以用来调用函数功能而不需要打开表格。
tpe：整数型，函数类型,只能为1、2、4、8。有返回值的函数一般设为2
funname：字符串，函数名称
function1：函数参数1
function2：函数参数2
...</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>根据函数类型决定是否有返回值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='i52c'>Import "LazyOffice.dll"

Dim x, index1, index2
x = LazyOffice.CallFunction(0, 1, "Sum", 1, 22, 35)
TracePrint x
index1 = LazyOffice.ExcelOpen("F:\\备份\\桌面\\1.xlsx", 1)
index2 = LazyOffice.ExcelOpen("F:\\备份\\桌面\\2.xlsx", 1)
x = LazyOffice.CallFunction(index1, 1, "Sum", LazyOffice.ObjRange(1, "A1:A3", index1))
TracePrint x
x = LazyOffice.CallFunction(index2, 1, "Sum", LazyOffice.ObjRange(2, "A1:A3", index2))
TracePrint x
x = LazyOffice.CallFunction(index1, 1, "Sum", LazyOffice.ObjRange(1, "A1:A3", index1), LazyOffice.ObjRange(2, "A1:A3", index2))
TracePrint x</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("i52c")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelBindByName '>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelBindByName </a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL文件已打开的情况下，通过文件名绑定EXCEL，不需要知道完整路径</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelBindByName(filename)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>filename：字符串，EXCEL文件名</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，索引值，本插件对多个EXCEL进行操作时需要。文件名不存在则返回空""</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='e6le'>Import "LazyOffice.dll"

Dim index, path
index = LazyOffice.ExcelBindByName("测试.xlsx")
If index <> "" Then 
    path= LazyOffice.ExcelPath(index)
    MsgBox "索引值：" & index & "\n文件路径：" & path    
End If</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("e6le")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelCells'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelCells</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL全表操作</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelCells(tag, parm1, parm2, idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，标签索引号或者字符串型旧的标签名称
parm1：字符串，操作对象
parm2：字符串，操作内容
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>所有可以设置的操作对象，均可尝试将值设为空字符串（""）以获取状态返回值
操作对象为"精确查找”或"模糊查找”时返回数组，第一个元素为找到的个数，其后为位置 </pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='osqd'>Import "LazyOffice.dll"

Dim index = LazyOffice.ExcelOpen("c:\\test.xls",1)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("osqd")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数2和参数3对应选项：
"水平对齐"："靠左"，"居中"，"靠右" 
"垂直对齐"："靠上"，"居中"，"靠下" 
"字形" "加粗"，"倾斜"， "加粗 倾斜" 
"复制"  不填或者填-1的话只复制 填大于0的正整数复制到对应标签页，填其他或者不填的话增加新标签页 
"字号"：整数型数值
"行高"：数值,设为小于0的负数则为自动设置
"精确查找"：字符串型需要查找的内容
"列宽"：数值,设为小于0的负数则为自动设置
"缩小字体填充"：不填或填True为缩小，False为取消
"字体"：系统字体，字符串型，如"隶书"，"宋体"
"自动换行"：不填或填True为自动换行，False为取消
"合并单元格"：填True为合并，False为拆分，填""时获取设定区域所在的合并单元格范围
"清除"："格式","批注","全部",填其他默认只清除内容
"字体颜色"：1至56的整数型数值或16进制RGB颜色，具体对应关系可通过运行ExcelOpen命令中的脚本例子进行查看，设为0表示使用自动配色
"背景颜色"：1至56的整数型数值或16进制RGB颜色，具体对应关系可通过运行ExcelOpen命令中的脚本例子进行查看，设为0表示无填充颜色
"格式"：本参数格式为"[格式],[格式代码],[中文类型]"，具体填法参照EXCEL单元格格式设置中的数字设置，如："常规"，"常规,中文小写"，"文本"，"数值,#,##0.000;-#,##0.00"，"数值,￥#,##0.000;-#,##0.00,中文大写"，"数值,yyyy年m月d日"
"打印"：ExcelCells命令中可直接设置为打印份数,或按照"打印份数,打印起始页-打印终止页,打印机名称"的格式设置，如"2,3-5"表示将第3到第5页打印2份，其他EXCEL操作命令中直接设置打印份数或按照"打印份数,打印机名称"的格式设置
"模糊查找"：字符串型需要查找的内容
"删除线"：不填或填True为缩小，False为取消
"插入"：区域操作中操作内容参数可设为"右"、"下"、"行"、"列"表示插入方式。行列操作中，操作内容参数设为0插入复制行列，设为大于0的整数插入相应数量的空行，设为其他插入一行</pre></td>
</tr></table>





<table class='help' id='ExcelCharColor'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelCharColor</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置单元格内某字符串颜色</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelCharColor(tag, arg, start, lenght, color[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
arg：字符串，单元格名称，如"A1”
statr：整数型，字符起始位置
lenght：整数型，字符长度
color：字符串，颜色值，1-56整数值，或者16进制颜色值，设为-1或""时获取指定字符颜色
idx：整数型，索引值 ，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='dj9m'>Import "LazyOffice.dll"

Dim index = LazyOffice.ExcelOpen("c:\\test.xls",0)
Call LazyOffice.ExcelWrite(1, 2, 2, "懒人插件命令测试", index)
Call LazyOffice.ExcelCharColor(1, "A1", 1, Len("懒人插件命令测试"), "FFF000", index)
Call LazyOffice.ExcelClose()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("dj9m")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelClass'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelClass</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>返回该组命令所在类名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelClass()</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>无</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，返回类名的名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='wsqu'>Import "LazyOffice.dll"

TracePrint LazyOffice.ExcelClass()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("wsqu")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelClose'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelClose</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>关闭EXCEL文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelClose(idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='mtkf'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.ExcelOpen("c:\test.xls",0)
Call LazyOffice.ExcelWrite(1, 2, 2, "懒人插件命令测试", index)
Call LazyOffice.ExcelCharColor(1, "B2", 1, Len("懒人插件命令测试"), "FF00FF", index)
Call LazyOffice.ExcelClose(index)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("mtkf")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelColumns'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelColumns</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL列操作</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelColumns(tag, rang, parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，整数型的标签索引号或者字符串型旧的标签名称
rang：操作范围
parm1：操作对象，可填的项目包括 "水平对齐"，"垂直对齐"，"自动换行"，"缩小字体填充"，"合并单元格"，"拆分单元格"，"字体"，"字形"，"字号" ，
"字体颜色"， "背景颜色"， "行高" ， "列宽" ， "删除线"，"清除"， "删除"， "插入"，"隐藏”，"精确查找" ，"模糊查找" ，"复制" ，"格式"
parm2：操作内容
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>所有可以设置的操作对象，均可尝试将值设为空字符串（""）以获取状态返回值
操作对象为"精确查找”或"模糊查找”时返回数组，第一个元素为找到的个数，其后为行号</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='mr_s'>Import "LazyOffice.dll"

//除插入和隐藏功能外，其他操作对象参数设置参见ExcelCells命令
LazyOffice.ExcelOpen "f:\\1.xls", 1
LazyOffice.ExcelColumns 1,"1:3","复制"
LazyOffice.ExcelColumns 1,7,"插入",0//向第7列插入复制列
LazyOffice.ExcelColumns 1,8,"插入",2//向第8列插入2列
LazyOffice.ExcelColumns 1,9,"隐藏",True//隐藏第9列
LazyOffice.ExcelColumns 1,9,"隐藏",False//显示第9列</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("mr_s")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelCopyTo'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelCopyTo</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL数据复制至</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelCopyTo(SurTag, SurRang, DstTag, DstRang, Tpe)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>SurTag：整数型，来源标签页，整数型的标签索引号或者字符串型旧的标签名称,为0时仅粘贴
SurRang：字符串，复制区域，格式为"区域,EXCEL索引号”，区域为""时整表复制
DstTag：整数型，去向标签页，整数型的标签索引号或者字符串型旧的标签名称,为0时仅粘贴
DstRang：字符串，粘贴区域，格式为同复制区域,默认为"A1:A1”，区域为""时整表粘贴
Tpe：整数型，复制方式，默认普通复制,填1相当于格式刷,2为只复制值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='l6xm'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.ExcelOpen("c:\\test.xls", 0)
Call LazyOffice.ExcelWrite(1, 2, 2, "懒人插件命令测试", index)
Call LazyOffice.ExcelCopyTo(1, "", 2, "", 1)
Call LazyOffice.ExcelClose()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("l6xm")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelFilter'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelFilter</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>筛选工作表</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelFilter(tag, title, column, filter[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，工作表第几页或标签名
title：整数型，标题行，每次使用ExcelFilterOver命令结束筛选之前此参数只有第一次设置的有效
column：整数型，需要筛选的列
filter：字符串，筛选条件 ，直接设置值，或者使用"<=6 and >0”及"=按??灵 or =懒人*”的格式
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回数组，第一个元素为筛选结果的总行数，其后为对应的行号 </pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='bzjq'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.ExcelOpen("c:\\test.xls", 0)
Call LazyOffice.ExcelFilter(1, 1, 2, ">=5", index)
Call LazyOffice.ExcelFilterOver(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("bzjq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelFilterData'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelFilterData</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取筛选工作表时下拉框中的数据</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelFilterData(tag, column[, rang, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，工作表第几页或标签名
column：整数型，列，整数型数值表示是第几列，或者直接使用列名称
rang：字符串，行号范围，格式如"3:7”，留空""则获取整列数据
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回数组，第一个元素为个数，其后为获取的内容 </pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='q1ta'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.ExcelOpen("c:\\test.xls", 0)
Call LazyOffice.ExcelFilterDatar(1, 1, "", index)
Call LazyOffice.ExcelFilterOver(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("q1ta")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelFilterOver'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelFilterOver</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>结束筛选工作表 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelFilterOver(tag, [, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，工作表第几页或标签名
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='q8sv'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.ExcelOpen("c:\\test.xls", 0)
Call LazyOffice.ExcelFilterDatar(1, 1, "", index)
Call LazyOffice.ExcelFilterOver(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("q8sv")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelGetPwd'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelGetPwd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>暴力破解EXCEL密码</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelGetPwd(path[, dict, tpe])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串，文件路径
dict：字典，默认为0，只检索数字。也可设为下列值：
1：检索数字+小写字母
2：检索数字+大小写字母
3：检索数字+字母+符号
或者自定义字典字符串，如"123asd",将只从设定字符中检索密码
tpe：布尔型，是否破解打开和修改权限密码，默认为True，填False将只获取打开密码</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回一个装载2个元素的数组，分别为打开权限密码和修改权限密码
若获取到的密码与设置密码不同，不要怀疑，先试试再说。</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='vwzo'>Import "LazyOffice.dll"

Dim path, sTime1, Pwd
path= "c:\\1.xls"
LazyOffice.ExcelOpen path,0
LazyOffice.ExcelProtect "打开","123"
LazyOffice.ExcelProtect "修改", "456"
LazyOffice.ExcelClose 
MsgBox "已在C盘创建了一个EXCEL表格，打开权限密码为123，修改权限密码为456。请检查。"
Pwd = LazyOffice.ExcelGetPwd(path, 0)
MsgBox "通过暴力破解得到密码为：\n" & join(Pwd, "\n")</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("vwzo")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelHideWindow'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelHideWindow</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>显示、隐藏EXCEL编辑窗口</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelHideWindow(isShow[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>isShow：布尔型，False或0表示隐藏 ，True或其他表示显示
idx：整数型，索引值 ，如果只用本插件打开了一个EXCEL，则可以留空，直接获取EXCEL窗口的句柄
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='cc7q'>Import "LazyOffice.dll"

Dim path
path= "c:\\1.xls"
Call LazyOffice.ExcelOpen(path, 1)
Delay 1000
Call LazyOffice.ExcelHideWindow(true)
Delay 1000
Call LazyOffice.ExcelHideWindow(false)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("cc7q")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelHwnd'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelHwnd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL窗口句柄</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelHwnd([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空，直接获取EXCEL窗口的句柄</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>该索引号对应的EXCEL的窗口句柄

</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ujmw'>Import "LazyOffice.dll"

Dim path
path= "c:\\test.xls"
Call LazyOffice.ExcelOpen(path, 1)
Delay 1000
TracePrint LazyOffice.ExcelHwnd()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ujmw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroCount'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取宏模块总数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelMacroCount([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，模块总数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='rmho'>Import "LazyOffice.dll"
 
Dim path, index, MacroIndex, str
path="c:\1.xls"
str="Range(""A1"").FormulaR1C1 = ""测试""" & "\n" & _
    "Range(""A1"").Interior.ColorIndex = 6" & "\n" & _
    "Range(""A1"").Font.ColorIndex = 3"
index = LazyOffice.ExcelOpen(path, 1)
MsgBox "准备写入宏"    
MacroIndex = LazyOffice.ExcelMacroWrite("TEST", str)
MsgBox "已写入"
Call LazyOffice.ExcelMacroRun("TEST")
MsgBox "已执行"
call LazyOffice.ExcelMacroRemove (MacroIndex )</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("rmho")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroGetName'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroGetName</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取宏模块名称或者索引值 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelMacroGetName(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>宏模块索引值或名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='w_op'>Import "LazyOffice.dll"
 
Dim path, index, MacroIndex, str
path="c:\1.xls"
str="Range(""A1"").FormulaR1C1 = ""测试""" & "\n" & _
    "Range(""A1"").Interior.ColorIndex = 6" & "\n" & _
    "Range(""A1"").Font.ColorIndex = 3"
index = LazyOffice.ExcelOpen(path, 1)
MsgBox "准备写入宏"    
MacroIndex = LazyOffice.ExcelMacroWrite("TEST", str)
MsgBox "已写入"
Call LazyOffice.ExcelMacroRun("TEST")
MsgBox "已执行"
call LazyOffice.ExcelMacroRemove (MacroIndex )</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("w_op")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroRead'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取宏模块</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelMacroRead(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，模块内容</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='r96x'>Import "LazyOffice.dll"
 
Dim path, index, MacroIndex, str
path="c:\1.xls"
str="Range(""A1"").FormulaR1C1 = ""测试""" & "\n" & _
    "Range(""A1"").Interior.ColorIndex = 6" & "\n" & _
    "Range(""A1"").Font.ColorIndex = 3"
index = LazyOffice.ExcelOpen(path, 1)
MsgBox "准备写入宏"    
MacroIndex = LazyOffice.ExcelMacroWrite("TEST", str)
MsgBox "已写入"
Call LazyOffice.ExcelMacroRun("TEST")
MsgBox "已执行"
call LazyOffice.ExcelMacroRemove (MacroIndex )</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("r96x")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroRemove'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroRemove</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>删除宏模块</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelMacroRemove(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='nazo'>Import "LazyOffice.dll"
 
Dim path, index, MacroIndex, str
path="c:\1.xls"
str="Range(""A1"").FormulaR1C1 = ""测试""" & "\n" & _
    "Range(""A1"").Interior.ColorIndex = 6" & "\n" & _
    "Range(""A1"").Font.ColorIndex = 3"
index = LazyOffice.ExcelOpen(path, 1)
MsgBox "准备写入宏"    
MacroIndex = LazyOffice.ExcelMacroWrite("TEST", str)
MsgBox "已写入"
Call LazyOffice.ExcelMacroRun("TEST")
MsgBox "已执行"
call LazyOffice.ExcelMacroRemove (MacroIndex )</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("nazo")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroRun'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroRun</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>执行宏命令</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelMacroRun(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='nryj'>Import "LazyOffice.dll"
 
Dim path, index, MacroIndex, str
path="c:\1.xls"
str="Range(""A1"").FormulaR1C1 = ""测试""" & "\n" & _
    "Range(""A1"").Interior.ColorIndex = 6" & "\n" & _
    "Range(""A1"").Font.ColorIndex = 3"
index = LazyOffice.ExcelOpen(path, 1)
MsgBox "准备写入宏"    
MacroIndex = LazyOffice.ExcelMacroWrite("TEST", str)
MsgBox "已写入"
Call LazyOffice.ExcelMacroRun("TEST")
MsgBox "已执行"
call LazyOffice.ExcelMacroRemove (MacroIndex )</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("nryj")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelMacroWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelMacroWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写入宏命令</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelMacroWrite(CmdName, MacroCode[, Macro, Idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>CmdName：字符串，命令名
MacroCode：字符串，宏代码
macro：宏模块名称或索引值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>宏代码所在模块名</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='tfvj'>Import "LazyOffice.dll"
 
Dim path, index, MacroIndex, str
path="c:\1.xls"
str="Range(""A1"").FormulaR1C1 = ""测试""" & "\n" & _
    "Range(""A1"").Interior.ColorIndex = 6" & "\n" & _
    "Range(""A1"").Font.ColorIndex = 3"
index = LazyOffice.ExcelOpen(path, 1)
MsgBox "准备写入宏"    
MacroIndex = LazyOffice.ExcelMacroWrite("TEST", str)
MsgBox "已写入"
Call LazyOffice.ExcelMacroRun("TEST")
MsgBox "已执行"
call LazyOffice.ExcelMacroRemove (MacroIndex )</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("tfvj")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelOpen'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelOpen</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>打开EXCEL文档,若EXCEL已经手动打开，则本命令仅返回操作所需的索引值而不影响表格</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelOpen(path[, tpe, pwd1, pwd2, onlyread])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串，文件路径
tpe：整数型，打开方法，0不可见,1为可见。默认为0
pwd1：打开权限密码，无密码则不需填写
pwd2：修改权限密码，无密码则不需填写
onlyread：整数型，设为1以只读模式打开</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>索引值，本插件对多个EXCEL进行操作时需要。索引值为从1开始计数的正整数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='nfnr'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("nfnr")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPath'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPath</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL完整路径</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPath([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，获取EXCEL完整路径</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='jg6c'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.ExcelPath(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("jg6c")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicCount'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>统计某标签页中图片数量 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicCount(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，图片数量</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='nt1t'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.ExcelPicCount(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("nt1t")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicDel'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>统计某标签页中图片数量 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicDel(tag, picid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
picid：整数型，图片序号，按照图片插入的顺序，最先插入的为1，然后为2，依次类推，序号填0时删除所有图片
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，图片数量</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='cule'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.ExcelPicCount(1, index)
Call LazyOffice.ExcelPicDel(1, 3, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("cule")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicInsert'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicInsert</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>插入图片，图片左上角位置为设定的行列值 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicInsert(tag, row, column, pic[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
pic：字符串，图片路径
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，返回插入图片的索引值
用此命令插入的图片，位置跟随设定的单元格变化</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='pk3f'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\test.png", index)
TracePrint LazyOffice.ExcelPicCount(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("pk3f")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicInsertEX'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicInsertEX</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>选定区域插入图片（自动调节图片大小）</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicInsertEX(tag, leftarg, rightarg, pic[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
leftarg：字符串，图片左上角单元格，格式如"A1"
rightarg：字符串，图片右下角单元格，格式如"A1"
pic：字符串，图片路径
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，返回插入图片的索引值
用此命令插入的图片，位置跟随设定的单元格变化</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='iqss'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\test.png", index)
Call LazyOffice.ExcelPicInsertEX(1, "A2", "B3", "c:\\test.png", index)
TracePrint LazyOffice.ExcelPicCount(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("iqss")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicLinkRead'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicLinkRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读图片超链接地址</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicLinkRead(tag, pic[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
pic：字符串，图片路径
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，返回插入图片的索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='mcwr'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
picid = LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\test.png", index)
TracePrint LazyOffice.ExcelPicLinkRead(1, picid, index)
TracePrint LazyOffice.ExcelPicCount(1, index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("mcwr")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicLinkWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicLinkWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>为图片设置超链接 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicLinkWrite(tag, picid, link[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
picid：整数型，图片索引值
link：字符串，链接地址
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，返回插入图片的索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='y03r'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
picid = LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\test.bmp", index)
TracePrint LazyOffice.ExcelPicLinkWrite(1, picid, "http://bbs.anjian.com", index)
TracePrint LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("y03r")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicRotate'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicRotate</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>旋转图片</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicRotate(tag, picid, angle[, isrotation, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
picid：整数型，图片索引值
angle：整数型，角度，-360到360的数值
isrotation：布尔值，是否直接设置图片角度，默认为True设置图片角度，填False则按照参数3设置的角度旋转图片，正数为顺时针，负数为逆时针
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，返回插入图片的索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='mqba'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
picid = LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\yzm.bmp", index)
TracePrint LazyOffice.ExcelPicRotate(1, picid, 90, true, index)
TracePrint LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("mqba")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicSave'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicSave</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保存图片</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelPicSave(tag, picid, path[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
picid：整数型，图片索引值
path：字符串，保存路径
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ew9n'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
picid = LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\yzm.bmp", index)
Call LazyOffice.ExcelPicSave(1, picid, "c:\\22.bmp", index)
TracePrint LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ew9n")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelPicSelected'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelPicSelected</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取当前选中的图片索引值 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelPicSelected(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
picid：整数型，图片索引值
path：字符串，保存路径
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>未选中时返回0，选中单个图片返回索引值，选中多个返回各图片索引值，用英文逗号隔开</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='iidm'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
picid = LazyOffice.ExcelPicInsert(1, 1, 1, "c:\\yzm.bmp", index)
TracePrint LazyOffice.ExcelPicSelected(1, index)
TracePrint LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("iidm")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelProtect'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelProtect</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置EXCEL文档密码 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelProtect(tpe, pwd[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tpe：字符串，设置的密码类型，可设置"打开"或"修改"
pwd：字符串，设置的密码
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='u6km'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
TracePrint LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("u6km")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelRange'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelRange</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL区域操作 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelRange(tag, rang, parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，整数型的标签索引号或者字符串型旧的标签名称
rang：字符串，操作范围
parm1：字符串，操作对象，可填的项目包括 "水平对齐"，"垂直对齐"，"自动换行"，"缩小字体填充"，"合并单元格"，"拆分单元格"，"字体"，"字形"，"字号" ，
"字体颜色"， "背景颜色"， "行高" ， "列宽" ，"删除线"， "清除"，"打印"， "插入"，"精确查找" ，"模糊查找" ，"复制" ，"格式" 
parm2：字符串，操作内容，对应不同的操作对象，本处可填写的内容各不相同，详见ExcelCells命令中的参数对照表。为空时返回单元格对应参数3的格式信息
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>所有可以设置的操作对象，均可尝试将值设为空字符串（""）以获取状态返回值
操作对象为"精确查找”或"模糊查找”时返回数组，第一个元素为找到的个数，其后为位置 

</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='bmjh'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("bmjh")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelRead'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取单元格内容</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelRead (tag, row, column[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，单元格内容</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='g1gb'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("g1gb")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReadComment'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReadComment</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取单元格批注</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelReadComment(tag, row, column[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，单元格批注</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='fgdt'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("fgdt")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReadEX'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReadEX</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取单元格文本</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelReadEX(tag, rang[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
rang：字符串，区域范围，如"A2:D6",表示从A2单元格到D6单元格的区域
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回二维数组，分别存放各单元格的内容，如 返回值(1,2)表示第一行第二列数据</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='eu_n'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("eu_n")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReadFormula'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReadFormula</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取单元格公式</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelReadFormula(tag, row, column[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>单元格公式，字符串型，无公式则返回单元格内容</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='h6ef'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("h6ef")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReadLink'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReadLink</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取超级链接 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelReadLink(tag, row, column[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，超级链接</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ssjl'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ssjl")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReadText'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReadText</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取单元格文本</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelReadText(tag, row, column[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，单元格内容</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='cmvp'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("cmvp")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelReplace'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelReplace</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取超级链接 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelReplace(tag, sur, dst[, rang, match, cap, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
sur：字符串，原内容
dst：字符串，新内容
rang：字符串，操作范围。默认为""，在整个标签页查找替换，也可设为"A1:D10","A:B","2:5"等格式
match：是否单元格匹配，默认为True
cap：是否区分大小写，默认为False
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='je5l'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelReplace(1, "原内容", "替换内容")
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("je5l")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelRestore'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelRestore</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>还原上次手动操作</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelRestore([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='x4dt'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelRestore(index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("x4dt")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelRows'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelRows</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL行操作</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ExcelRows(tag, rang, parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，整数型的标签索引号或者字符串型旧的标签名称
rang：操作范围
parm1：操作对象，可填的项目包括 "水平对齐"，"垂直对齐"，"自动换行"，"缩小字体填充"，"合并单元格"，"拆分单元格"，"字体"，"字形"，"字号" ，
"字体颜色"， "背景颜色"， "行高" ， "列宽" ， "删除线"，"清除"， "删除"， "插入"，"隐藏”，"精确查找" ，"模糊查找" ，"复制" ，"格式"
parm2：操作内容
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>所有可以设置的操作对象，均可尝试将值设为空字符串（""）以获取状态返回值
操作对象为"精确查找”或"模糊查找”时返回数组，第一个元素为找到的个数，其后为列号</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='p01d'>Import "LazyOffice.dll"

//除插入和隐藏功能外，其他操作对象参数设置参见ExcelCells命令
LazyOffice.ExcelOpen "f:\1.xls", 1
LazyOffice.ExcelRows 1,"1:3","复制"
LazyOffice.ExcelRows 1,7,"插入",0//向第7行插入复制行
LazyOffice.ExcelRows 1,8,"插入",2//向第8行插入2行
LazyOffice.ExcelRows 1,9,"隐藏",True//隐藏第9行
LazyOffice.ExcelRows 1,9,"隐藏",False//显示第9行</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("p01d")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelSave'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelSave</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保存EXCEL文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelSave([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='tm6y'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("tm6y")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelSaveAs'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelSaveAs</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>EXCEL文档另存为</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelSaveAs(path[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串，存放路径，后缀可为.xls.xlt.html.htm.mht.mhtml.xml.txt.csv.xlsx.xlsm.xlsb
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='y03r'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("y03r")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelSetComment'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelSetComment</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre></pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelSetComment(tag, row, column[, font, style, size, fontcolor, bkgndcolor, border, comment, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型，标签索引号或者字符串型旧的标签名称
row：整数型，行
column：整数型，列
font：字体，可填"宋体"等系统字体名，为""时装载字体设置
style：字形，可填"常规"、"加粗"、"倾斜"、"加粗 倾斜"，为""时装载字形设置
size：字号，-1或""时装载字号设置
fontcolor：字体颜色值，1至56的整数型数值，-1或""时装载颜色设置
bkgndcolor：背景颜色值，1至56的整数型数值，-1或""时装载颜色设置
border：有无边框，True为有，False为无
comment：批注是否可见，True为可见，False为隐藏
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ccxj'>Dim p
p = "C:\\测试.xls"
LazyOffice.ExcelOpen p, 1
LazyOffice.ExcelWriteComment 1,1,1,"这是一个批注"
Call LazyOffice.ExcelSetComment(1, 1, 1, "楷体_GB2312", "加粗", 12, 3, 15, true, true)
MsgBox "批注写入设置完毕"
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ccxj")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelSort'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelSort</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>选定区域排序 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelSort(tag, rang, column[, column1, column2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表第几页或标签名
rang：操作范围
column：关键列1，格式为"列号,升/降”，如"1,降"表示第1列降序排列，或直接填写列号默认升序
column1：关键列2，格式同关键列1
column2：关键列3，格式同关键列1
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='k47s'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelSort(1, "", "1,降")
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("k47s")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写入单元格内容 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelWrite(tag, row, column, str[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
str：字符串，内容
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='kbxh'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("kbxh")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelWriteComment'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelWriteComment</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写入单元格批注</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelWriteComment(tag, row, column, comment[,isshow, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
column：字符串，批注内容，设为""时删除批注
isshow：布尔型，批注是否可见，True为可见，False为隐藏
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='pq4b'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelWriteComment(1, 1, 1, "批注")
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("pq4b")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelWriteEX'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelWriteEX</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写入区域内容</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelWriteEX(tag, rang, arr[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
rang：字符串，区域范围，如"A2:D6",表示从A2单元格到D6单元格的区域，请确保此区域大于需要写入的二维数组区域
arr：二维数组名，此数组应用ExcelReadEX命令生成后进行赋值
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='yjgc'>Import "LazyOffice.dll"

Dim a, b, d, table
a=LazyOffice.ExcelOpen ("C:\\test.xls")
table=LazyOffice.ExcelReadEX(1, "A2:Q1010")
For i = 1 To 1000
    For j = 1 To 16
        table(i, j) = i * j
    Next
Next
b=LazyOffice.ExcelWriteEX(1, "A2:Q1010", table)
d=LazyOffice.ExcelClose() </pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("yjgc")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ExcelWriteLink'>
<tr><th>命令名称：</th>
<td class='name'><a>ExcelWriteLink</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写超级链接</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub ExcelWriteLink(tag, row, column[, link, linkname, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
row：整数型，行
column：整数型，列
link：字符串，超级链接地址，留空则清除超级链接，默认为""
linkname：字符串，超级链接名称
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='hbqi'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.ExcelWriteLink(1, 1, 1, "http://bbs.anjian.com", "按键论坛", index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("hbqi")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='LocToAdd'>
<tr><th>命令名称：</th>
<td class='name'><a>LocToAdd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>单元格坐标转名称，如（3,2）单元格转换后返回"B3”</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function LocToAdd(row, column)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>row：整数型，行
column：整数型，列</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，单元格名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='hjgv'>Import "LazyOffice.dll"

TracePrint LazyOffice.LocToAdd(3,2)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("hjgv")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ObjRange'>
<tr><th>命令名称：</th>
<td class='name'><a>ObjRange</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>区域对象</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ObjRange(tag, rang[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
rang：字符串，区域
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数1为0时返回工作薄对象
参数2为""时返回工作表对象，否则返回设定区域的对象
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='yndp'>Import "LazyOffice.dll"

Dim index, obj
index = LazyOffice.ExcelOpen("c:\\1.xlsx", 1)
obj = LazyOffice.ObjRange(1, "A1", Index)
MsgBox obj.Value
obj = LazyOffice.ObjRange(1, "A1:B3", Index)
MsgBox obj(2,2)
obj = LazyOffice.ObjRange(1, "A:B", Index)
MsgBox obj.Address
obj = LazyOffice.ObjRange(1, "", Index)
MsgBox obj.Name
obj = LazyOffice.ObjRange(0, "", Index)
MsgBox obj.FullName</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("yndp")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetAdd'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetAdd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>增加一个新的工作标签</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetAdd([tag, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：用来设置增加标签的位置或名称，如设置为字符串，则在所有标签最后增加一个相应名称的标签页；如设置为整型数值，则在相应位置插入一个标签页，如数值不合理，将增加到最后。
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，新增加的标签页索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='j97h'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.SheetAdd("新标签页", index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("j97h")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetColumnsCount'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetColumnsCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL总列数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetColumnsCount(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，EXCEL中某标签页的表格总列数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='x0rj'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetColumnsCount(1, index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("x0rj")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetCount'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL总列数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetCount([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，标签总数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='r8hx'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetCount(index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("r8hx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetDel'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL总列数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub SheetDel(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='wmnx'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetDel(1, index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("wmnx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetGetName'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetGetName</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取标签名称</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetGetName(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：标签序号或名称。如设置为整型序号，返回对应标签的名称，如设置为字符串型名称，返回对应标签的序号
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，标签名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='kmvh'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetGetName(1, index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("kmvh")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetIndex'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetIndex</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取标签名称</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetIndex([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，当前标签的序号</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ch9m'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetIndex(index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ch9m")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetMove'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetMove</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>移动标签</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetMove(surtag, dsttag[, copy, surid, dstid])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>surtag：原标签整型序号或者字符串型名称
dsttag：新标签，若设为整型序号，将移动到对应位置；若设为字符串型名称，将在移动到对应EXCEL后重命名标签页
copy：布尔型，是否建立副本，默认为False不建立
surid：整型类型，原标签的EXCEL索引号，默认为1
dstid：整型类型，新标签的EXCEL索引号，默认为参数4所设置的值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>新标签</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='sk4x'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetMove(1, 3)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("sk4x")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetProtect'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetProtect</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保护工作表 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub SheetProtect(tag, tpe, pwd, obj[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
tpe：设置的操作类型，可设置'保护'或'撤销'或'增加区域'或'删除区域'
pwd：字符串型密码
obj：字符串型对象设置
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='nknn'>Import "LazyOffice.dll"

Dim path, i, name, index, x, icolor, rang, txtArr, txt
path="C:\\测试.xls"
index=LazyOffice.ExcelOpen(path,1)
//统计EXCEL共有多少标签页,无参数
i=LazyOffice.SheetCount(index)
MsgBox "本EXCEL共有标签页数: "&i
//在所有标签页后新增一个标签页，无参数，返回新标签的页码
x=LazyOffice.SheetAdd(0,index)
MsgBox "新建标签页码为: "&x
name=LazyOffice.SheetGetName(x,index)
MsgBox name
//重命名指定的标签页
Call LazyOffice.SheetRename(x,"测试",index)
MsgBox "已将第" & x & "个标签页更名为“测试”"
//删除指定标签页。参数为指定标签页的页码数或者标签名
Call LazyOffice.SheetDel(i,index)
MsgBox "已删除第"&i&"个标签页"
MsgBox "标签部分演示完毕，下面进行页面内容的设置"
Call LazyOffice.SheetRename(2,"EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelCells("EXCEL中颜色数值查看表","垂直对齐","居中",index)
Call LazyOffice.ExcelCells(2,"水平对齐","居中",index)
Call LazyOffice.ExcelCells(2,"字形","加粗",index)
//设置并生成表头
Call LazyOffice.ExcelRange(2,"A1:H1","合并单元格",True,Index)
Call LazyOffice.ExcelWrite(2, 1, 1, "EXCEL中颜色数值查看表",index)
Call LazyOffice.ExcelRange(2,"A1","背景颜色",1,index)
Call LazyOffice.ExcelRange(2,"A1","字体颜色",33,index)
Call LazyOffice.ExcelRange(2,"A1","字体","楷体_GB2132",index)
Call LazyOffice.ExcelRange(2,"A1","字号",26,index)
//输出表格正文
Call LazyOffice.ExcelRows(2,"2:8","行高",30,index)
Call LazyOffice.ExcelColumns(2,"A:H","列宽",12,index)
for n=2 to 8
    for m=1 to 8
        icolor=8*(n-2)+m
        rang=LazyOffice.LocToAdd(n,m)
        Call LazyOffice.ExcelRange(2,rang,"背景颜色",icolor,index)
        If icolor=1 then
            Call LazyOffice.ExcelRange(2,rang,"字体颜色",2,index)
        End If 
        Call LazyOffice.ExcelWrite(2, n, m, "颜色值："& icolor,index)
    next
next
txtArr=LazyOffice.ExcelReadEX(2,"A1:H8",index)
MsgBox "第2行第4列内容为："& txtArr(2,4)
txt=LazyOffice.ExcelRead(2,5,8,index)
MsgBox "第5行第8列内容为："&txt
MsgBox "下面演示清除，如需保留本表格内容，请删除脚本中下面的清除部分重新生成。"
Call LazyOffice.ExcelRange(2,"B2","清除",index)
MsgBox "已清除单元格B2处内容"
//注意，当此行或列包含与其他行或列和并的单元格时"清除”命令无效
Call LazyOffice.ExcelRows(2,3,"清除",index)
MsgBox "已清除第3行内容"
Call LazyOffice.ExcelCells(2,"清除",index)
MsgBox "已清除标签页全部内容"
//加密
Call LazyOffice.ExcelProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.ExcelProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//命令演示完毕，关闭EXCEL文件
Call LazyOffice.ExcelClose(index)
MsgBox "演示结束，请查看"


</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("nknn")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetRangeSelected'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetRangeSelected</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取选中区域的范围</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetRangeSelected(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>选中单元格时返回如"A1”；选中范围时返回如"A1:C3”；选中多个范围时返回如"A1,B1:C3,A5:D6”</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='htev'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetRangeSelected(1, index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("htev")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetRename'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetRename</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>重命名标签</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub SheetRename(tag, newtag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
newtag：新名称
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='sgku'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetRename(1, "新标签名, "index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("sgku")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetRowsCount'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetRowsCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL总行数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetRowsCount(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，EXCEL中某标签页的表格总行数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='w2ot'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetRowsCount(1, "index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("w2ot")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetSetBorders'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetSetBorders</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置边框</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub SheetSetBorders(tag, rang, mask[, style, width, color, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
rang：操作范围
mask：整数型，边框位置，"1,2,4,8,16,32”分别表示"上,下,左,右,中间横线,中间竖线”，可用1+2+4+8表示区域四周边框;设为0时清除所有边框
style：边框线类型，0到13的整数，默认为1
width：边框线宽度，1到4的整数，默认为2
color：边框线颜色，-1到56的整数或者16进制颜色值，默认为0表示自动，填-1则清除边框
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='c7vu'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetSetBorders(1, "A1:B5", 1+2+4+8)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("c7vu")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetSetPage'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetSetPage</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置边框</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub SheetSetPage(tag, parm1, parm2[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
parm1：操作对象，可填的项目包括 "方向"，"标题行"，"标题列"，"页眉左"，"页眉中"，"页眉右"，"页脚左"，"页脚中" ，
"页脚右"， "左边距"， "右边距" ， "上边距" ， "下边距"，"页眉边距" ，"页脚边距" ，"水平居中"，"垂直居中"，"缩放" ，"调整页宽" ，"调整页高"  ，"纸张大小" ，"打印顺序" 
parm2：操作内容，对应不同的操作对象，本处可填写的内容各不相同，详见下面参数说明中的对照表。对于页眉页脚，参数3为0时获取设置值；对于其他操作对象，参数3为""时获取设置值，
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='pgdd'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetSetBorders(1, "A1:B5", 1+2+4+8)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("pgdd")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数2和参数3对应选项：
"方向"："横向"，"纵向"
"标题行"：字符串型，填写标题行范围，如"1:1"
"页眉左"：字符串型，左边页眉内容
"页眉中"：字符串型，中间页眉内容
"页眉右"：字符串型，右边页眉内容
"左边距"：数值型，边距值
"上边距"：数值型，边距值
"页眉边距"：数值型，边距值
"纸张大小"：：填写字符串型纸张名称，目前只支持"A4","A5","16K","16开","B5"。不在前面所列的纸张大小，可直接填写纸张对应的常数值
"调整页宽"：整数型数值，自动调整为几页宽，设置后缩放设置将失效
"水平居中"：True,False
"调整页高"：整数型数值，自动调整为几页高，设置后缩放设置将失效
"标题列"：字符串型，填写标题列范围，如"A:A"
"页脚左"：字符串型，左边页脚内容
"页脚中"：字符串型，中间页脚内容
"页脚右"：：字符串型，右边页脚内容
"右边距"：：数值型，边距值
"下边距"：：数值型，边距值
"页脚边距"：：数值型，边距值
"打印顺序"："先列后行"，"先行后列"
"缩放"：整数型数值，缩放比例
"垂直居中"：True,False</pre></td>
</tr></table>





<table class='help' id='WordBindByName'>
<tr><th>命令名称：</th>
<td class='name'><a>WordBindByName</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>Word文件已打开的情况下，通过文件名绑定Word，不需要知道完整路径</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordBindByName(filename)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>filename：字符串，WORD文件名</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，索引值，本插件对多个WORD进行操作时需要</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='icri'>Import "LazyOffice.dll"

TracePrint LazyOffice.WordBindByName("测试.doc")
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("icri")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordClass'>
<tr><th>命令名称：</th>
<td class='name'><a>WordClass</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>返回该组命令所在类名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordClass()</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>无</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，返回类名的名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='mpmb'>Import "LazyOffice.dll"

TracePrint LazyOffice.WordClass()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("mpmb")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordClose'>
<tr><th>命令名称：</th>
<td class='name'><a>WordClose</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>关闭EXCEL文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordClose(idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='r3tb'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
Call LazyOffice.WordWrite("懒人插件命令测试", index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("r3tb")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordFind'>
<tr><th>命令名称：</th>
<td class='name'><a>WordFind</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>关闭EXCEL文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordFind(str[, parm, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>str：字符串，要查找的内容
parm：从当前位置往后查找的次数，光标选中找到的内容；设为0时在文档中查找所有内容，执行完毕后光标将选中当前位置后面的第一个查找内容；设为字符串时，查找所有内容并替换为该字符串。
idx：整数型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数2为0时返回数组，第一个元素为找到的个数，其后各元素存放找到的内容起始位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='f31c'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
Call LazyOffice.WordFind("懒人插件命令测试", "查找替换", index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("f31c")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordGetCursorEnd'>
<tr><th>命令名称：</th>
<td class='name'><a>WordGetCursorEnd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取当前光标的结束位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordGetCursorEnd([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，当前光标的结束位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='pzpi'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
TracePrint LazyOffice.WordGetCursorEnd(index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("pzpi")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordGetCursorStart'>
<tr><th>命令名称：</th>
<td class='name'><a>WordGetCursorStart</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取当前光标起始位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordGetCursorStart([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，当前光标的起始位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='qxfw'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
TracePrint LazyOffice.WordGetCursorStart(index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("qxfw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordGetPwd'>
<tr><th>命令名称：</th>
<td class='name'><a>WordGetPwd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>暴力破解Word密码</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordGetPwd(path[, dict, tpe])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串，文件路径
dict：字典，默认为0，只检索数字。也可设为下列值：
1：检索数字+小写字母
2：检索数字+大小写字母
3：检索数字+字母+符号
或者自定义字典字符串，如"123asd",将只从设定字符中检索密码
tpe：布尔型，是否破解打开和修改权限密码，默认为True，填False将只获取打开密码</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回一个装载2个元素的数组，分别为打开和修改权限密码
若获取到的密码与设置密码不同，不要怀疑，先试试再说。</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='vlcw'>Import "LazyOffice.dll"

Dim path, sTime1, Pwd
path= "c:\\test.doc"
LazyOffice.WordOpen path,0
LazyOffice.WordProtect "打开","123"
LazyOffice.WordProtect "修改", "456"
LazyOffice.WordClose 
MsgBox "已在C盘创建了一个Word文档，打开权限密码为123，修改权限密码为456。请检查。"
Pwd = LazyOffice.WordGetPwd(path, 0)
MsgBox "通过暴力破解得到密码为：\n" & join(Pwd, "\n")</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("vlcw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordInsertBreak'>
<tr><th>命令名称：</th>
<td class='name'><a>WordInsertBreak</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>当前位置插入分隔符 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordInsertBreak(tpe[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tpe：字符串类型，分隔符名称，可设为"分页符"、"换行符"、"分栏符"
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ldxb'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
TracePrint LazyOffice.WordWrite("懒人插件命令测试", index)
Call LazyOffice.WordInsertBreak("分栏符", index)
TracePrint LazyOffice.WordWrite("懒人插件命令测试1", index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ldxb")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordKeyPress'>
<tr><th>命令名称：</th>
<td class='name'><a>WordKeyPress</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>文档内按快捷键</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordKeyPress(tpe[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tpe：字符串类型，快捷键名称。如"CTRL+C"或"BACKSPACE"
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='hogx'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
TracePrint LazyOffice.WordWrite("懒人插件命令测试", index)
Call LazyOffice.WordKeyPress("BACKSPACE", index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("hogx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroCount'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取宏模块总数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordMacroCount([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，模块总数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='l1lq'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc", 0)
TracePrint LazyOffice.WordMacroCount(index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("l1lq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroGetName'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroGetName</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取宏模块名称或者索引值 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordMacroGetName(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>宏模块索引值或名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='qprj'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc", 0)
TracePrint LazyOffice.WordMacroGetName(1, index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("qprj")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroRead'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取宏模块</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordMacroRead(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，模块内容</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='hjeu'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc", 0)
TracePrint LazyOffice.WordMacroRead(1, index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("hjeu")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroRemove'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroRemove</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>删除宏模块</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordMacroRemove(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='duxf'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc", 0)
TracePrint LazyOffice.WordMacroRemove(1, index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("duxf")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroRun'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroRun</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>执行宏命令</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordMacroRun(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='zxsw'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc", 0)
TracePrint LazyOffice.WordMacroRun("DelPart", index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("zxsw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写入宏命令</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordMacroWrite(CmdName, MacroCode[, Macro, Idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>CmdName：字符串，命令名
MacroCode：字符串，宏代码
macro：模块名称或索引值，如果忽略或设置为""或0，则增加一个新模块
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>宏代码所在模块名</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='flzw'>Import "LazyOffice.dll"

Dim index, str
index = LazyOffice.WordOpen("c:\\test.doc", 0)
str = "ActiveDocument.Paragraphs(1).Style = ActiveDocument.Styles(""标题 1"")" & _
    "Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter"
Call LazyOffice.WordMacroWrite("SetStyle", str)
Call LazyOffice.WordMacroRun("SetStyle")
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("flzw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordOpen'>
<tr><th>命令名称：</th>
<td class='name'><a>WordOpen</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>打开Word文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordOpen(path[, tpe, pwd1, pwd2, onlyread])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串，文件路径
tpe：整数型，打开方法，0不可见,1为可见。默认为0
pwd1：打开权限密码，无密码则不需填写
pwd2：修改权限密码，无密码则不需填写
onlyread：整数型，设为1以只读模式打开</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回WORD索引号，其他操作需要</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='coki'>Import "LazyOffice.dll"
Import "File.dll"

Dim path, index, word, Text
path = "C:\\a.doc"
//打开Word文档，为了演示，将第二个参数(可选参数)设为1使其可见，默认为不可见
index = LazyOffice.WordOpen(path,1)
word = LazyOffice.WordReadEX(index)
Call File.WriteFileEx("C:\\b.txt", word)
MsgBox "Word全文为："&word
Text = File.ReadFileEx(".\\QMScript\\排列组合.Q")
Text = replace(Text,"|",chr(10))
Text = left(Text,len(Text)-1)
Call LazyOffice.WordWriteEX(Text,index)
MsgBox "全文重写完毕"
Call LazyOffice.WordSetCursor("段", 0,"",0,index)
MsgBox "已跳转至开头"
Call LazyOffice.WordSetCursor("段",8,"下",0,index)
MsgBox "已跳转至第9段开头"
Call LazyOffice.WordSetCursor("字",8,"右",1,index)
Call LazyOffice.WordKeyPress("BACKSPACE",index)
MsgBox "已删除开头8个字符"
Call LazyOffice.WordSetCursor("字",-1,"", 1,index)
word = LazyOffice.WordRead(index)
MsgBox "选中文字为:"&word
Call LazyOffice.WordWrite("测试",index)
MsgBox "已写入新文字"
Call LazyOffice.WordInsertBreak("分页符",index)
MsgBox "已插入新页"
Call LazyOffice.WordPicInsert("C:\\图片.jpg",index)
MsgBox "已插入图片"
Call LazyOffice.WordSetCursor("段",-1,"", 1,index)
MsgBox "已到达到最后一段的开头"
Call LazyOffice.WordSetCursor("字",-1,"", 1,index)
MsgBox "已到达最后"
//加密
Call LazyOffice.WordProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.WordProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//操作结束关闭Word文档
Call LazyOffice.WordClose(index)
MsgBox "演示结束"

</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("coki")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPath'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPath</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取Word文件路径</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPath([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，获取完整路径</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='xpey'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordPath(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("xpey")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicCount'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>统计文档中图片数量 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicCount([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值

</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，图片数量</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='v29q'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordPicCount(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("v29q")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicDel'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>统计某标签页中图片数量 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordPicDel(picid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整型类型，图片索引值。设为0时删除所有图片
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='bq6k'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordPicDel(3, index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("bq6k")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicInsert'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicInsert</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>当前位置插入图片</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicInsert(pic[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>pic：字符串，图片路径
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回图片的索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='rksv'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordPicInsert("c:\\test.png", index)
Call LazyOffice.WordClose(index)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("rksv")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicLinkRead'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicLinkRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读图片超链接地址</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicLinkRead(picid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整型类型，图片索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串类型，链接地址</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='nlcg'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
picid = LazyOffice.WordPicInsert("c:\\test.png", index)
Call LazyOffice.WordPicLinkWrite(picid, "http://bbs.anjian.com", index)
TracePrint LazyOffice.WordPicLinkRead(picid, index) 
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("nlcg")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicLinkWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicLinkWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>图片添加超链接 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicLinkWrite(picid, link[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整数型，图片索引值
link：字符串类型，链接地址。设为""时清除超链接
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ry7x'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
picid = LazyOffice.WordPicInsert("c:\\test.png", index)
Call LazyOffice.WordPicLinkWrite(picid, "http://bbs.anjian.com", index)
TracePrint LazyOffice.WordPicLinkRead(picid, index) 
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ry7x")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicLoc'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicLoc</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取图片位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicLoc(picid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整型类型，图片索引值
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，图片起始位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='wmdx'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
picid = LazyOffice.WordPicInsert("c:\\test.png", index)
TracePrint LazyOffice.WordPicLoc(picid, index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("wmdx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicSave'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicSave</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保存图片</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordPicSave(picid, path[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整数型，图片索引值
path：字符串，保存路径
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='h7qv'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
picid = LazyOffice.WordPicSelected(index)
Call LazyOffice.WordPicSave(picid, "c:\\22.bmp", index)
TracePrint LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("h7qv")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicSelected'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicSelected</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取当前选中的图片索引值</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicSelected([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>选中内容中无图片时返回0，选中内容中有图片时返回各个图片的索引值，用","隔开，需要使用时通过Cint转换为整型</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='v8ag'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
picid = LazyOffice.WordPicSelected(index)
Call LazyOffice.WordPicSave(picid, "c:\\22.bmp", index)
TracePrint LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("v8ag")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicSize'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicSize</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>改变图片大小</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicSize(picid[, width, hight, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整型类型，图片索引值
width：宽
hight：高
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数2、参数3均设为-1时返回"宽*高"格式尺寸</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='zl5x'>Import "LazyOffice.dll"

Dim path, Index, PicIndex, Str
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
PicIndex= LazyOffice.WordPicInsert("C:\\图片.jpg", Index)
Str = LazyOffice.WordPicSize(PicIndex,-1,-1, Index)
MsgBox str
Call LazyOffice.WordPicSize(PicIndex,12,8, Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("zl5x")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPrint'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPrint</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre></pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordPrint(page[, quantity, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>page：打印对象。设为0时打印全文，-1时打印当前页，或者按照"1,3,5"、"1-3,5"、"1-5"等格式设置打印页码。
quantity：打印份数，默认为1。也可按"份数,打印机名称"用来设置默认打印机
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='f9cx'>Import "LazyOffice.dll"

Dim path, Index, PicIndex, Str
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordPrint(0,1,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("f9cx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordProtect'>
<tr><th>命令名称：</th>
<td class='name'><a>WordProtect</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置Word文档密码 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordProtect(tpe, pwd[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tpe：字符串，设置的密码类型，可设置"打开"或"修改"
pwd：字符串，设置的密码
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='v3ok'>Import "LazyOffice.dll"

Dim path, index
path="C:\\测试.doc"
index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.WordProtect("修改","456",index)
MsgBox "已设置修改密码为456"
TracePrint LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("v3ok")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordRead '>
<tr><th>命令名称：</th>
<td class='name'><a>WordRead </a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取当前选中文字</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordRead([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，文字内容
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='k4it'>Import "LazyOffice.dll"

Dim path, Index, PicIndex, Str
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordRead(Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("k4it")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordReadEX '>
<tr><th>命令名称：</th>
<td class='name'><a>WordReadEX </a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取Word文档全文</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordReadEX([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，文字内容
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ohdl'>Import "LazyOffice.dll"

Dim path, Index, PicIndex, Str
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordReadEX(Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ohdl")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordReadLink'>
<tr><th>命令名称：</th>
<td class='name'><a>WordReadLink</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取当前选取文字中的超链接</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordReadLink([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回数组，第一个为个数，其后为链接信息，格式为："位置|文字|链接"
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='t5jl'>Import "LazyOffice.dll"

Dim path, Index, Arr
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Arr = LazyOffice.WordReadLink(Index)
TracePrint Join(Arr, "\n")
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("t5jl")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordRestore'>
<tr><th>命令名称：</th>
<td class='name'><a>WordRestore</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>还原上次手动操作</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordRestore([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='r85w'>Import "LazyOffice.dll"

Dim path, Index, Arr
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordRestore(Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("r85w")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordSave'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSave</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保存Word文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordSave([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='n9oh'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordSave(Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("n9oh")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordSaveAs'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSaveAs</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保存Word文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordSaveAs(path[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：存放路径,后缀可为.doc.dot.html.htm.mht.mhtml.xml.txt.rtf.docx.docm
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='kmky'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordSaveAs("C:\\test.doc", Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("kmky")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordSetChar'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSetChar</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置当前选中文本 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordSetChar(parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>parm1：字符串类型，操作对象。可设为"字体"，"字号"，"字色"，"底色"，"居中"，"靠左"，"靠右"，"加粗"，"倾斜"，"下划线"，"边框"，"缩放"，"删除线"，"上标"，"下标"，"空心"，"间距"
parm2：操作内容，不同的操作对象使用不同的内容
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>部分操作对象，当参数2设为""时有返回值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='paqy'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)

// 设置字体，参数2设为""时将返回选中文本设置的值
Call LazyOffice.WordSetChar("字体", "隶书", Index)
TracePrint LazyOffice.WordSetChar("字体", "", Index)

// 设置字号，参数2设为""时将返回选中文本设置的值。
Call LazyOffice.WordSetChar("字号", 15, Index)
TracePrint LazyOffice.WordSetChar("字号", "", Index)

// 设置字体颜色，参数2设为""时将返回选中文本设置的值。
Call LazyOffice.WordSetChar("字色", "FF00FF", Index)
TracePrint LazyOffice.WordSetChar("字色", "", Index)

// 设置字体底色，参数2设为""时将返回选中文本设置的值。
Call LazyOffice.WordSetChar("底色", 3, Index)
TracePrint LazyOffice.WordSetChar("底色", "", Index)

// 设置字形，参数2省略
Call LazyOffice.WordSetChar("加粗", "", Index)
Call LazyOffice.WordSetChar("倾斜", "", Index)

// 设置下划线，参数2为下划线颜色，设为""时清除下划线
Call LazyOffice.WordSetChar("下划线", "0000FF", Index)

// 设置删除线，参数2使用布尔型，True为添加，False为清除
Call LazyOffice.WordSetChar("删除线", True, Index)

// 设置文字缩放，参数2为1-600的整数值，设为100时是原大小
Call LazyOffice.WordSetChar("缩放", 50, Index)

// 设置文字间距，参数2为""时将返回选中文本设置的值
Call LazyOffice.WordSetChar("间距", 20, Index)
TracePrint LazyOffice.WordSetChar("间距", "", Index)

// 设置上标、下标、空心，参数2使用布尔型，True为设置，False为取消
Call LazyOffice.WordSetChar("上标", True, Index)
Call LazyOffice.WordSetChar("下标", True, Index)
Call LazyOffice.WordSetChar("空心", True, Index)

Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("paqy")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>Word文字背景颜色值对应表
1 000000 
2 FF0000 
3 FFFF00 
4 00FF00 
5 FF00FF  
6 0000FF  
7 00FFFF  
8 FFFFFF  
9 800000  
10 808000  
11 008000  
12 800080  
13 000080  
14 008080  
15 808080  
16 C0C0C0 </pre></td>
</tr></table>





<table class='help' id='WordSetCursor'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSetCursor</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>移动光标位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordSetCursor(unit[, step, dir, shift, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>unit：移动单位，可设为"段"、"字"、"行"，或直接设置非负整数值指定移动到第几个字符位置
step：整型类型，移动数量，一般设置正整数；设为0时移动到全文或者本段开头，设为-1移动到全文或者本段结尾
dir：字符串类型，移动方向，可填"上"、"下"、"左"、"右"
shift：整型类型，设置移动时是否按下Shift,0为不按，1为按下。默认为0
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回移动后光标的起始位置

</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='g4ce'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
// 选中从当前位置开始的5个字符
TracePrint LazyOffice.WordSetCursor("字", 5, 0, 1, Index)
// 移动到第5个字符
TracePrint LazyOffice.WordSetCursor(5, 0, 0, 0,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("g4ce")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordSetPage'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSetPage</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>页面设置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordSetPage(parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>parm1：字符串类型，操作对象。可设为"方向"，"左边距"，"右边距"，"上边距"，"下边距"，"页眉边距"，"页脚边距"，"页眉"，"页脚"，"纸张大小"
parm2：操作内容，不同的操作对象使用不同的内容
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数2设为""时有返回值
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='c6wu'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
// 设置纸张大小
// 参数2设置纸张大小，目前只支持"A4","A5","B5"。不在前面所列的纸张大小，可直接填写纸张"宽*高"格式尺寸。参数2设为""时获取目前所用纸张"宽*高"格式尺寸,单位：厘米
Call LazyOffice.WordSetPage("纸张大小", "A4", Index)
TracePrint LazyOffice.WordSetPage("纸张大小", "", Index)

// 设置页脚边距，参数2设置边距值，单位：厘米，设为""时返回设置值。
Call LazyOffice.WordSetPage("页脚边距", 1.4, Index)
TracePrint LazyOffice.WordSetPage("页脚边距", "", Index)

// 设置页脚，参数2为要设置的页脚内容，设为""时返回文档页脚。
Call LazyOffice.WordSetPage("页脚", "测试写入页脚", Index)
TracePrint LazyOffice.WordSetPage("页脚", "", Index)

// 设置页眉边距，参数2设置边距值，单位：厘米，设为""时返回设置值。
Call LazyOffice.WordSetPage("页眉边距", 1.4, Index)
TracePrint LazyOffice.WordSetPage("页眉边距", "", Index)

// 设置页眉，参数2为要设置的页眉内容，设为""时返回文档页眉。
Call LazyOffice.WordSetPage("页眉", "测试写入页眉", Index)
TracePrint LazyOffice.WordSetPage("页眉", "", Index)

// 调整页边距，参数2设置边距值，单位：厘米，设为""时返回设置值。
Call LazyOffice.WordSetPage("上边距", 2.1, Index)
Call LazyOffice.WordSetPage("下边距", 1.8, Index)
Call LazyOffice.WordSetPage("左边距", 1.4, Index)
Call LazyOffice.WordSetPage("右边距", 1.5, Index)
TracePrint LazyOffice.WordSetPage("右边距", "", Index)

// 设置页面方向，参数2可设置为"横向"、"纵向"，设为""时返回设置值。
Call LazyOffice.WordSetPage("方向", "横向", Index)
TracePrint LazyOffice.WordSetPage("方向", "", Index)

Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("c6wu")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordSetPara'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSetPara</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置当前光标所在段落</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordSetPara(parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>parm1：字符串类型，操作对象。可设为"左缩进"，"右缩进"，"首行缩进"，"段前间距"，"段后间距"，"行距"，"对齐方式"，"大纲级别"
parm2：操作内容，不同的操作对象使用不同的内容
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='yirm'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)

// 设置缩进，参数2可设为缩进的字符数
Call LazyOffice.WordSetPara("首行缩进", 2, Index)
Call LazyOffice.WordSetPara("左缩进", 2, Index)
Call LazyOffice.WordSetPara("右缩进", 2, Index)

// 设置间距、行距，参数2设为间距行数
Call LazyOffice.WordSetPara("段前间距", 1.5, Index)
Call LazyOffice.WordSetPara("行距", 10, Index)

// 设置对齐方式，参数2可设为"居中"、"左对齐"、"右对齐"、"分散对齐"、"两端对齐"实现
Call LazyOffice.WordSetPara("对齐方式", "右对齐", Index)

// 设置大纲级别，参数2设置级别数值，大纲级别1-9级分别用数字1-9表示，正文文本级别用10表示
Call LazyOffice.WordSetPara("大纲级别", 10, Index)

Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("yirm")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordStat'>
<tr><th>命令名称：</th>
<td class='name'><a>WordStat</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取WORD文档统计信息</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordStat(tpe[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tpe：整型类型，0-6的数值，要获取的信息类型。0：字；1：行；2：页；3：字符(无空格)；4：段落；5：字符(带空格)；6：中文字符或朝鲜语单词
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>对应信息类型的统计数值

</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='nj_o'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordStat(2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("nj_o")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableBorders'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableBorders</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置表格边框</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableBorders(tabid, mask[, tpe, width, color, bkgcolor, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
mask：整型类型，边框位置，"1,2,4,8,16,32”分别表示"上,下,左,右,中间横线,中间竖线”。例如，可用1+2+4+8表示区域四周边框;设为0时清除所有边框
tpe：整型类型，边框线类型，0到24的整数，默认为1
width：单位为磅，默认为1磅。具体支持的宽度可自行查看WORD中设置表格边框宽度可以选择的磅数值
color：边框线颜色，16进制颜色值，默认为"FF000000"表示使用默认颜色，填"F000000"则清除边框
bkgcolor：表格底纹颜色，16进制颜色值，默认为"FF000000"表示使用默认颜色
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='b8iw'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex= LazyOffice.WordTableInsert(3,4,3.5, Index)
Call LazyOffice.WordTableBorders(TBIndex, 1+2+4+8, 1, 3, "000000", Index)
Call LazyOffice.WordTableBorders(TBIndex, 16+32, 2, 1, "0000FF", Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("b8iw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableCellsMerge'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableCellsMerge</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>合并表格内单元格</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableCellsMerge(tabid, srow, scolumn, erow, ecolumn[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
srow：整型类型，起始单元格行号
scolumn：整型类型，起始单元格列号
erow：整型类型，结尾单元格行号
ecolumn：整型类型，结尾单元格列号
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='w_bh'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex= LazyOffice.WordTableInsert(3,4,3.5, Index)
Call LazyOffice.WordTableCellsMerge(1,1,1,1,3,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("w_bh")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableCellsSplit '>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableCellsSplit </a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>表格内拆分单元格</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableCellsSplit(tabid, row, column[, rows, columns, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，单元格行号
column：整型类型，单元格列号
rows：整型类型，拆分为几行，默认为1
columns：整型类型，拆分为几列，默认为1
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='wrbc'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex= LazyOffice.WordTableInsert(3,4,3.5, Index)
Call LazyOffice.WordTableCellsSplit(1,1,1,2,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("wrbc")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableColAdd'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableColAdd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>在表格指定列号前增加一列 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableColAdd(tabid[, row, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，列号，默认为0。设为合理列号则在指定行左侧插入一列，设为0则在表格最后增加一列。
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='jfhc'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
Call LazyOffice.WordTableWrite(TBIndex,1,1,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,1,2,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,1,3,"测试内容", Index)
Call LazyOffice.WordTableColAdd(TBIndex,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("jfhc")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableColCount'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableColCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取表格总列数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableColCount(tabid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，总列数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='w4qe'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordTableColCount(1,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("w4qe")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableColDel'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableColDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>表格删除一列</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableColDel(tabid[, column, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
column：整型类型，列号
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='l69u'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordTableColDel(1,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("l69u")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableColWidth'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableColWidth</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置表格列宽</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableColWidth(tabid, column, width[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
column：整型类型，列号
width：列宽，设为0时自动调整列宽
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数3为-1时获取列宽</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ywiv'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordTableColWidth(1,2,-1,Index)
Call LazyOffice.WordTableColWidth(1,2,4.5,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ywiv")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableDel'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>删除文档中表格</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableDel(tabid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值。设为0时删除所有表格。
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='eaop'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordTableDel(1,Index)
Call LazyOffice.WordClose(Index)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("eaop")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableInsert'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableInsert</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>当前位置插入表格 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableInsert(row, column[, width, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>row：整型类型，表格行数
column：整型类型，表格列数
width：表格列宽类型。-2为根据窗口调整，-1根据内容调整，非负数为固定列宽并使用此参数作为列宽
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，表格索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='r_6x'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex= LazyOffice.WordTableInsert(3,4,3.5, Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("r_6x")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableLoc'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableLoc</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取表格位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableLoc(tabid[,idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，表格起始位置
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='hbqo'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
TracePrint LazyOffice.WordTableLoc(TBIndex, Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("hbqo")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableRead'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取表格内值</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableRead(tabid, row, column[,idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，行号
column：整型类型，列号
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串类型，值
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ospd'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
TracePrint LazyOffice.WordTableRead(TBIndex,1,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ospd")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableRowAdd'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableRowAdd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>在表格指定行号前增加一行</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableRowAdd(tabid[, row, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，行号，默认为0。设为合理行号则在指定行上方插入一行，设为0则在表格最后增加一行
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='tg5k'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
Call LazyOffice.WordTableWrite(TBIndex,1,1,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,2,1,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,3,1,"测试内容", Index)
Call LazyOffice.WordTableRowAdd(TBIndex,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("tg5k")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableRowCount'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableRowCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取表格总行数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableRowCount(tabid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，总行数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='h6el'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordTableRowCount(1,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("h6el")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableRowDel'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableRowDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>表格删除一行</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableRowDel(tabid[, row, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，行号
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='jg7v'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordTableRowDel(1,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("jg7v")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableRowHight'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableRowHight</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置表格列宽</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableRowHight(tabid, column, hight[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
column：整型类型，行号
hight：行高
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ht2n'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
TracePrint LazyOffice.WordTableRowHight(1,2,-1,Index)
Call LazyOffice.WordTableRowHight(1,2,4.5,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ht2n")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableSelected'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableSelected</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取当前选中表格的索引值 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableSelected([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>选中内容中无表格时返回0，选中内容中有表格时返回各个表的索引值，用","隔开，需要使用时通过Cint转换为整型</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='j34k'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
TracePrint LazyOffice.WordTableSelected(Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("j34k")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableSet'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableSet</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置表格</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableSet(tabid, parm1, parm2[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
parm1：字符串类型，可用对象包括"水平对齐"，"垂直对齐"，"左边距"，"右边距"，"上边距"，"下边距"，"表格转文本"，"文本转表格"，"选中全表"，"选中单元格"
parm2：操作内容，不同的操作对象使用不同的内容
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数3为""时返回对应对象的值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='w2cs'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
// 设置对齐方式
TracePrint LazyOffice.WordTableSet(TBIndex,"水平对齐","", Index)
Call LazyOffice.WordTableSet(TBIndex,"水平对齐","居中", Index)
Call LazyOffice.WordTableSet(TBIndex, "垂直对齐", "居中", Index)

// 设置单元格边距
TracePrint LazyOffice.WordTableSet(TBIndex,"左边距","", Index)
Call LazyOffice.WordTableSet(TBIndex,"左边距",0.2, Index)
Call LazyOffice.WordTableSet(TBIndex,"右边距",0.3, Index)
Call LazyOffice.WordTableSet(TBIndex,"上边距",0.4, Index)
Call LazyOffice.WordTableSet(TBIndex,"下边距",0.5, Index)

// 表格转文本
Call LazyOffice.WordTableWrite(TBIndex,1,1,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,1,2,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,2,2,"测试内容", Index)
Call LazyOffice.WordTableSet(TBIndex,"表格转文本","|", Index)

// 文本转表格
Call LazyOffice.WordWriteEX("测|试|文" & "\n" & "本||转" & "\n" & "|表|格", Index)
Call LazyOffice.WordSetCursor("段",-1,0,1,Index)
TBIndex = LazyOffice.WordTableSet(0,"文本转表格","|", Index)

Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("w2cs")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数2填写"水平对齐"时，参数3可使用"居中"、"靠右"、"靠左"进行设置。参数3填""时返回当前设置，返回值为整型值，分别用1、2、3表示"居中"、"靠右"、"靠左"。
  参数2填写"垂直对齐"时，参数3可使用"居中"、"靠下"、"靠上"进行设置。参数3填""时返回当前设置，返回值为整型值，分别用1、0、3表示"居中"、"靠下"、"靠上"。
参数2填写"左边距"、"右边距"、"上边距"、"下边距"时，参数3可使用厘米单位的数值来设置单元格边距。参数3填""时返回当前设置。
参数2填写"表格转文本"时，参数3设置转为文本时的分隔符。
</pre></td>
</tr></table>





<table class='help' id='WordTableWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>表格内写入值</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableWrite(tabid, row, column, value[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，行号
column：整型类型，列号
value：值
idx：整型类型，WORD索引值


</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='s3wc'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
Call LazyOffice.WordTableWrite(TBIndex,1,2,"测试内容", Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("s3wc")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>WordWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>从当前位置写入内容</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordWrite(value[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>value：字符串型，内容
idx：整型类型，WORD索引值


</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='lbvq'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordSetCursor("字",2,"右",1,index)
Call LazyOffice.WordWrite("测试插入内容",Index)
Call LazyOffice.WordClose(Index)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("lbvq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordWriteEX'>
<tr><th>命令名称：</th>
<td class='name'><a>WordWriteEX</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>重写Word文档，替换原有内容</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordWriteEX(value[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>value：字符串型，内容
idx：整型类型，WORD索引值


</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='qpsx'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordWriteEX("测试重写内容",Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("qpsx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordWriteLink'>
<tr><th>命令名称：</th>
<td class='name'><a>WordWriteLink</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>当前选中文字添加超链接</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordWriteLink(link[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>link：字符串类型，链接地址，当设为""时清除选中文字中所有链接
idx：整型类型，WORD索引值


</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ep_s'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordSetCursor("字",2,"右",1,index)
Call LazyOffice.WordWriteLink("http://www.baidu.com", Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ep_s")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>









<table class='help' id='LocToAdd'>
<tr><th>命令名称：</th>
<td class='name'><a>LocToAdd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>单元格坐标转名称，如（3,2）单元格转换后返回"B3”</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function LocToAdd(row, column)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>row：整数型，行
column：整数型，列</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，单元格名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='zf4j'>Import "LazyOffice.dll"

TracePrint LazyOffice.LocToAdd(3,2)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("zf4j")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='ObjRange'>
<tr><th>命令名称：</th>
<td class='name'><a>ObjRange</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>区域对象</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function ObjRange(tag, rang[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
rang：字符串，区域
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数1为0时返回工作薄对象
参数2为""时返回工作表对象，否则返回设定区域的对象
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='yvtw'>Import "LazyOffice.dll"

Dim index, obj
index = LazyOffice.ExcelOpen("c:\\1.xlsx", 1)
obj = LazyOffice.ObjRange(1, "A1", Index)
MsgBox obj.Value
obj = LazyOffice.ObjRange(1, "A1:B3", Index)
MsgBox obj(2,2)
obj = LazyOffice.ObjRange(1, "A:B", Index)
MsgBox obj.Address
obj = LazyOffice.ObjRange(1, "", Index)
MsgBox obj.Name
obj = LazyOffice.ObjRange(0, "", Index)
MsgBox obj.FullName</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("yvtw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetAdd'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetAdd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>增加一个新的工作标签</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetAdd([tag, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：用来设置增加标签的位置或名称，如设置为字符串，则在所有标签最后增加一个相应名称的标签页；如设置为整型数值，则在相应位置插入一个标签页，如数值不合理，将增加到最后。
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，新增加的标签页索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ondz'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
Call LazyOffice.SheetAdd("新标签页", index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ondz")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetColumnsCount'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetColumnsCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL总列数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetColumnsCount(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：工作表页，可用整数型数值表示是第几个工作表标签，也可用字符串型的标签名称
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，EXCEL中某标签页的表格总列数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='eqyl'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetColumnsCount(1, index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("eqyl")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetCount'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL总列数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetCount([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，标签总数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='dvve'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetCount(index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("dvve")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetDel'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL总列数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub SheetDel(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='dblg'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetDel(1, index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("dblg")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetGetName'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetGetName</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取标签名称</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetGetName(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：标签序号或名称。如设置为整型序号，返回对应标签的名称，如设置为字符串型名称，返回对应标签的序号
idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，标签名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='xc4i'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetGetName(1, index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("xc4i")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetIndex'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetIndex</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取当前标签索引号 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetIndex([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，当前标签的序号</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='oezt'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetIndex(index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("oezt")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetMove'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetMove</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>移动标签</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetMove(surtag, dsttag[, copy, surid, dstid])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>surtag：原标签整型序号或者字符串型名称
dsttag：新标签，若设为整型序号，将移动到对应位置；若设为字符串型名称，将在移动到对应EXCEL后重命名标签页
copy：布尔型，是否建立副本，默认为False不建立
surid：整型类型，原标签的EXCEL索引号，默认为1
dstid：整型类型，新标签的EXCEL索引号，默认为参数4所设置的值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>新标签</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='mjmm'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetMove(1, 3)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("mjmm")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetProtect'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetProtect</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保护工作表 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub SheetProtect(tag, tpe, pwd, obj[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
tpe：设置的操作类型，可设置'保护'或'撤销'或'增加区域'或'删除区域'
pwd：字符串型密码
obj：字符串型对象设置
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='s9uh'>Import "LazyOffice.dll"

Dim path,Index
path = "C:\\测试.xls"
Index = LazyOffice.ExcelOpen(path, 1)
Call LazyOffice.SheetProtect(1,"删除区域","","",index)
Call LazyOffice.SheetProtect(1,"增加区域","456","A:E",index)
Call LazyOffice.SheetProtect(1,"保护","123","1110000001000",index)
msgbox "已保护第1个标签页并允许用户对设定的区域设置格式及使用自动筛选"
Call LazyOffice.SheetProtect(1,"撤销","123","",index)
Call LazyOffice.ExcelClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("s9uh")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetRangeSelected'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetRangeSelected</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取选中区域的范围</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetRangeSelected(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>选中单元格时返回如"A1”；选中范围时返回如"A1:C3”；选中多个范围时返回如"A1,B1:C3,A5:D6”</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='o_dq'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetRangeSelected(1, index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("o_dq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetRename'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetRename</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>重命名标签</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub SheetRename(tag, newtag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
newtag：新名称
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='x3pu'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetRename(1, "新标签名, "index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("x3pu")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetRowsCount'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetRowsCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取EXCEL总行数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function SheetRowsCount(tag[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，EXCEL中某标签页的表格总行数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='vzdh'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetRowsCount(1, "index)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("vzdh")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetSetBorders'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetSetBorders</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置边框</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub SheetSetBorders(tag, rang, mask[, style, width, color, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
rang：操作范围
mask：整数型，边框位置，"1,2,4,8,16,32”分别表示"上,下,左,右,中间横线,中间竖线”，可用1+2+4+8表示区域四周边框;设为0时清除所有边框
style：边框线类型，0到13的整数，默认为1
width：边框线宽度，1到4的整数，默认为2
color：边框线颜色，-1到56的整数或者16进制颜色值，默认为0表示自动，填-1则清除边框
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='vxup'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetSetBorders(1, "A1:B5", 1+2+4+8)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("vxup")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='SheetSetPage'>
<tr><th>命令名称：</th>
<td class='name'><a>SheetSetPage</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置边框</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub SheetSetPage(tag, parm1, parm2[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tag：整数型的标签索引号或者字符串型旧的标签名称
parm1：操作对象，可填的项目包括 "方向"，"标题行"，"标题列"，"页眉左"，"页眉中"，"页眉右"，"页脚左"，"页脚中" ，
"页脚右"， "左边距"， "右边距" ， "上边距" ， "下边距"，"页眉边距" ，"页脚边距" ，"水平居中"，"垂直居中"，"缩放" ，"调整页宽" ，"调整页高"  ，"纸张大小" ，"打印顺序" 
parm2：操作内容，对应不同的操作对象，本处可填写的内容各不相同，详见下面参数说明中的对照表。对于页眉页脚，参数3为0时获取设置值；对于其他操作对象，参数3为""时获取设置值，
idx：索引值，如果只用本插件打开了一个EXCEL，则可以留空</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='kful'>Import "LazyOffice.dll"

Dim path, index
path ="c:\\1.xls"
index = LazyOffice.ExcelOpen(path, 0)
TracePrint LazyOffice.SheetSetBorders(1, "A1:B5", 1+2+4+8)
Call LazyOffice.ExcelClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("kful")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数2和参数3对应选项：
"方向"："横向"，"纵向"
"标题行"：字符串型，填写标题行范围，如"1:1"
"页眉左"：字符串型，左边页眉内容
"页眉中"：字符串型，中间页眉内容
"页眉右"：字符串型，右边页眉内容
"左边距"：数值型，边距值
"上边距"：数值型，边距值
"页眉边距"：数值型，边距值
"纸张大小"：：填写字符串型纸张名称，目前只支持"A4","A5","16K","16开","B5"。不在前面所列的纸张大小，可直接填写纸张对应的常数值
"调整页宽"：整数型数值，自动调整为几页宽，设置后缩放设置将失效
"水平居中"：True,False
"调整页高"：整数型数值，自动调整为几页高，设置后缩放设置将失效
"标题列"：字符串型，填写标题列范围，如"A:A"
"页脚左"：字符串型，左边页脚内容
"页脚中"：字符串型，中间页脚内容
"页脚右"：：字符串型，右边页脚内容
"右边距"：：数值型，边距值
"下边距"：：数值型，边距值
"页脚边距"：：数值型，边距值
"打印顺序"："先列后行"，"先行后列"
"缩放"：整数型数值，缩放比例
"垂直居中"：True,False</pre></td>
</tr></table>





<table class='help' id='WordBindByName'>
<tr><th>命令名称：</th>
<td class='name'><a>WordBindByName</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>Word文件已打开的情况下，通过文件名绑定Word，不需要知道完整路径</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordBindByName(filename)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>filename：字符串，WORD文件名</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，索引值，本插件对多个WORD进行操作时需要</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='higv'>Import "LazyOffice.dll"

TracePrint LazyOffice.WordBindByName("测试.doc")
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("higv")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordClass'>
<tr><th>命令名称：</th>
<td class='name'><a>WordClass</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>返回该组命令所在类名</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordClass()</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>无</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，返回类名的名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='gndp'>Import "LazyOffice.dll"

TracePrint LazyOffice.WordClass()</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("gndp")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordClose'>
<tr><th>命令名称：</th>
<td class='name'><a>WordClose</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>关闭EXCEL文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordClose(idx)</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='mdbj'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
Call LazyOffice.WordWrite("懒人插件命令测试", index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("mdbj")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordFind'>
<tr><th>命令名称：</th>
<td class='name'><a>WordFind</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>关闭EXCEL文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordFind(str[, parm, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>str：字符串，要查找的内容
parm：从当前位置往后查找的次数，光标选中找到的内容；设为0时在文档中查找所有内容，执行完毕后光标将选中当前位置后面的第一个查找内容；设为字符串时，查找所有内容并替换为该字符串。
idx：整数型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数2为0时返回数组，第一个元素为找到的个数，其后各元素存放找到的内容起始位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='t4vt'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
Call LazyOffice.WordFind("懒人插件命令测试", "查找替换", index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("t4vt")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordGetCursorEnd'>
<tr><th>命令名称：</th>
<td class='name'><a>WordGetCursorEnd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取当前光标的结束位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordGetCursorEnd([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，当前光标的结束位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='qygx'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
TracePrint LazyOffice.WordGetCursorEnd(index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("qygx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordGetCursorStart'>
<tr><th>命令名称：</th>
<td class='name'><a>WordGetCursorStart</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取当前光标起始位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordGetCursorStart([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整数型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，当前光标的起始位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='vlcx'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
TracePrint LazyOffice.WordGetCursorStart(index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("vlcx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordGetPwd'>
<tr><th>命令名称：</th>
<td class='name'><a>WordGetPwd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>暴力破解Word密码</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordGetPwd(path[, dict, tpe])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串，文件路径
dict：字典，默认为0，只检索数字。也可设为下列值：
1：检索数字+小写字母
2：检索数字+大小写字母
3：检索数字+字母+符号
或者自定义字典字符串，如"123asd",将只从设定字符中检索密码
tpe：布尔型，是否破解打开和修改权限密码，默认为True，填False将只获取打开密码</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回一个装载2个元素的数组，分别为打开和修改权限密码
若获取到的密码与设置密码不同，不要怀疑，先试试再说。</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='d1lr'>Import "LazyOffice.dll"

Dim path, sTime1, Pwd
path= "c:\\test.doc"
LazyOffice.WordOpen path,0
LazyOffice.WordProtect "打开","123"
LazyOffice.WordProtect "修改", "456"
LazyOffice.WordClose 
MsgBox "已在C盘创建了一个Word文档，打开权限密码为123，修改权限密码为456。请检查。"
Pwd = LazyOffice.WordGetPwd(path, 0)
MsgBox "通过暴力破解得到密码为：\n" & join(Pwd, "\n")</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("d1lr")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordInsertBreak'>
<tr><th>命令名称：</th>
<td class='name'><a>WordInsertBreak</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>当前位置插入分隔符 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordInsertBreak(tpe[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tpe：字符串类型，分隔符名称，可设为"分页符"、"换行符"、"分栏符"
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ktlu'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
TracePrint LazyOffice.WordWrite("懒人插件命令测试", index)
Call LazyOffice.WordInsertBreak("分栏符", index)
TracePrint LazyOffice.WordWrite("懒人插件命令测试1", index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ktlu")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordKeyPress'>
<tr><th>命令名称：</th>
<td class='name'><a>WordKeyPress</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>文档内按快捷键</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordKeyPress(tpe[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tpe：字符串类型，快捷键名称。如"CTRL+C"或"BACKSPACE"
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='bm7g'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc",0)
TracePrint LazyOffice.WordWrite("懒人插件命令测试", index)
Call LazyOffice.WordKeyPress("BACKSPACE", index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("bm7g")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroCount'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取宏模块总数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordMacroCount([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，模块总数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='y03y'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc", 0)
TracePrint LazyOffice.WordMacroCount(index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("y03y")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroGetName'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroGetName</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取宏模块名称或者索引值 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordMacroGetName(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>宏模块索引值或名称</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='fgbt'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc", 0)
TracePrint LazyOffice.WordMacroGetName(1, index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("fgbt")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroRead'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取宏模块</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordMacroRead(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，模块内容</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='tilv'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc", 0)
TracePrint LazyOffice.WordMacroRead(1, index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("tilv")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroRemove'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroRemove</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>删除宏模块</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordMacroRemove(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='qkgn'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc", 0)
TracePrint LazyOffice.WordMacroRemove(1, index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("qkgn")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroRun'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroRun</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>执行宏命令</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordMacroRun(macro[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>macro：宏模块名称或索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ip3a'>Import "LazyOffice.dll"

Dim index
index = LazyOffice.WordOpen("c:\\test.doc", 0)
TracePrint LazyOffice.WordMacroRun("DelPart", index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ip3a")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordMacroWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>WordMacroWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>写入宏命令</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordMacroWrite(CmdName, MacroCode[, Macro, Idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>CmdName：字符串，命令名
MacroCode：字符串，宏代码
macro：模块名称或索引值，如果忽略或设置为""或0，则增加一个新模块
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>宏代码所在模块名</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='p52u'>Import "LazyOffice.dll"

Dim index, str
index = LazyOffice.WordOpen("c:\\test.doc", 0)
str = "ActiveDocument.Paragraphs(1).Style = ActiveDocument.Styles(""标题 1"")" & _
    "Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter"
Call LazyOffice.WordMacroWrite("SetStyle", str)
Call LazyOffice.WordMacroRun("SetStyle")
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("p52u")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordOpen'>
<tr><th>命令名称：</th>
<td class='name'><a>WordOpen</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>打开Word文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordOpen(path[, tpe, pwd1, pwd2, onlyread])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：字符串，文件路径
tpe：整数型，打开方法，0不可见,1为可见。默认为0
pwd1：打开权限密码，无密码则不需填写
pwd2：修改权限密码，无密码则不需填写
onlyread：整数型，设为1以只读模式打开</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回WORD索引号，其他操作需要</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='exle'>Import "LazyOffice.dll"
Import "File.dll"

Dim path, index, word, Text
path = "C:\\a.doc"
//打开Word文档，为了演示，将第二个参数(可选参数)设为1使其可见，默认为不可见
index = LazyOffice.WordOpen(path,1)
word = LazyOffice.WordReadEX(index)
Call File.WriteFileEx("C:\\b.txt", word)
MsgBox "Word全文为："&word
Text = File.ReadFileEx(".\\QMScript\\排列组合.Q")
Text = replace(Text,"|",chr(10))
Text = left(Text,len(Text)-1)
Call LazyOffice.WordWriteEX(Text,index)
MsgBox "全文重写完毕"
Call LazyOffice.WordSetCursor("段", 0,"",0,index)
MsgBox "已跳转至开头"
Call LazyOffice.WordSetCursor("段",8,"下",0,index)
MsgBox "已跳转至第9段开头"
Call LazyOffice.WordSetCursor("字",8,"右",1,index)
Call LazyOffice.WordKeyPress("BACKSPACE",index)
MsgBox "已删除开头8个字符"
Call LazyOffice.WordSetCursor("字",-1,"", 1,index)
word = LazyOffice.WordRead(index)
MsgBox "选中文字为:"&word
Call LazyOffice.WordWrite("测试",index)
MsgBox "已写入新文字"
Call LazyOffice.WordInsertBreak("分页符",index)
MsgBox "已插入新页"
Call LazyOffice.WordPicInsert("C:\\图片.jpg",index)
MsgBox "已插入图片"
Call LazyOffice.WordSetCursor("段",-1,"", 1,index)
MsgBox "已到达到最后一段的开头"
Call LazyOffice.WordSetCursor("字",-1,"", 1,index)
MsgBox "已到达最后"
//加密
Call LazyOffice.WordProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.WordProtect("修改","456",index)
MsgBox "已设置修改密码为456"
//操作结束关闭Word文档
Call LazyOffice.WordClose(index)
MsgBox "演示结束"

</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("exle")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPath'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPath</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取Word文件路径</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPath([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，获取完整路径</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='t07p'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordPath(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("t07p")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicCount'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>统计文档中图片数量 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicCount([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值

</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整数型，图片数量</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='seuc'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordPicCount(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("seuc")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicDel'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>统计某标签页中图片数量 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordPicDel(picid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整型类型，图片索引值。设为0时删除所有图片
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='yu2d'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordPicDel(3, index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("yu2d")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicInsert'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicInsert</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>当前位置插入图片</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicInsert(pic[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>pic：字符串，图片路径
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回图片的索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='nlcg'>Import "LazyOffice.dll"

Dim path, index
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordPicInsert("c:\\test.png", index)
Call LazyOffice.WordClose(index)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("nlcg")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicLinkRead'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicLinkRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读图片超链接地址</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicLinkRead(picid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整型类型，图片索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串类型，链接地址</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='koxq'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
picid = LazyOffice.WordPicInsert("c:\\test.png", index)
Call LazyOffice.WordPicLinkWrite(picid, "http://bbs.anjian.com", index)
TracePrint LazyOffice.WordPicLinkRead(picid, index) 
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("koxq")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicLinkWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicLinkWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>图片添加超链接 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicLinkWrite(picid, link[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整数型，图片索引值
link：字符串类型，链接地址。设为""时清除超链接
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='i3uk'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
picid = LazyOffice.WordPicInsert("c:\\test.png", index)
Call LazyOffice.WordPicLinkWrite(picid, "http://bbs.anjian.com", index)
TracePrint LazyOffice.WordPicLinkRead(picid, index) 
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("i3uk")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicLoc'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicLoc</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取图片位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicLoc(picid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整型类型，图片索引值
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，图片起始位置</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='pj2f'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
picid = LazyOffice.WordPicInsert("c:\\test.png", index)
TracePrint LazyOffice.WordPicLoc(picid, index)
Call LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("pj2f")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicSave'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicSave</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保存图片</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordPicSave(picid, path[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整数型，图片索引值
path：字符串，保存路径
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='waco'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
picid = LazyOffice.WordPicSelected(index)
Call LazyOffice.WordPicSave(picid, "c:\\22.bmp", index)
TracePrint LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("waco")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicSelected'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicSelected</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取当前选中的图片索引值</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicSelected([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>选中内容中无图片时返回0，选中内容中有图片时返回各个图片的索引值，用","隔开，需要使用时通过Cint转换为整型</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='tdxs'>Import "LazyOffice.dll"

Dim path, index, picid
path="c:\\1.doc"
index = LazyOffice.WordOpen(path, 0)
picid = LazyOffice.WordPicSelected(index)
Call LazyOffice.WordPicSave(picid, "c:\\22.bmp", index)
TracePrint LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("tdxs")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPicSize'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPicSize</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>改变图片大小</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordPicSize(picid[, width, hight, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>picid：整型类型，图片索引值
width：宽
hight：高
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数2、参数3均设为-1时返回"宽*高"格式尺寸</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ssul'>Import "LazyOffice.dll"

Dim path, Index, PicIndex, Str
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
PicIndex= LazyOffice.WordPicInsert("C:\\图片.jpg", Index)
Str = LazyOffice.WordPicSize(PicIndex,-1,-1, Index)
MsgBox str
Call LazyOffice.WordPicSize(PicIndex,12,8, Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ssul")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordPrint'>
<tr><th>命令名称：</th>
<td class='name'><a>WordPrint</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre></pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordPrint(page[, quantity, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>page：打印对象。设为0时打印全文，-1时打印当前页，或者按照"1,3,5"、"1-3,5"、"1-5"等格式设置打印页码。
quantity：打印份数，默认为1。也可按"份数,打印机名称"用来设置默认打印机
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='fh2t'>Import "LazyOffice.dll"

Dim path, Index, PicIndex, Str
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordPrint(0,1,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("fh2t")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordProtect'>
<tr><th>命令名称：</th>
<td class='name'><a>WordProtect</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置Word文档密码 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordProtect(tpe, pwd[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tpe：字符串，设置的密码类型，可设置"打开"或"修改"
pwd：字符串，设置的密码
idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='n8mw'>Import "LazyOffice.dll"

Dim path, index
path="C:\\测试.doc"
index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordProtect("打开","123",index)
MsgBox "已设置打开密码为123"
Call LazyOffice.WordProtect("修改","456",index)
MsgBox "已设置修改密码为456"
TracePrint LazyOffice.WordClose(index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("n8mw")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordRead '>
<tr><th>命令名称：</th>
<td class='name'><a>WordRead </a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取当前选中文字</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordRead([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，文字内容
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='e2yb'>Import "LazyOffice.dll"

Dim path, Index, PicIndex, Str
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordRead(Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("e2yb")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordReadEX '>
<tr><th>命令名称：</th>
<td class='name'><a>WordReadEX </a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取Word文档全文</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordReadEX([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串，文字内容
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='cgut'>Import "LazyOffice.dll"

Dim path, Index, PicIndex, Str
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordReadEX(Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("cgut")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordReadLink'>
<tr><th>命令名称：</th>
<td class='name'><a>WordReadLink</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取当前选取文字中的超链接</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordReadLink([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值
</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回数组，第一个为个数，其后为链接信息，格式为："位置|文字|链接"
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='bmjh'>Import "LazyOffice.dll"

Dim path, Index, Arr
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Arr = LazyOffice.WordReadLink(Index)
TracePrint Join(Arr, "\n")
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("bmjh")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordRestore'>
<tr><th>命令名称：</th>
<td class='name'><a>WordRestore</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>还原上次手动操作</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordRestore([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='qetk'>Import "LazyOffice.dll"

Dim path, Index, Arr
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordRestore(Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("qetk")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordSave'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSave</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保存Word文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordSave([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ghfu'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordSave(Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ghfu")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordSaveAs'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSaveAs</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>保存Word文档</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordSaveAs(path[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>path：存放路径,后缀可为.doc.dot.html.htm.mht.mhtml.xml.txt.rtf.docx.docm
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='l5ku'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordSaveAs("C:\\test.doc", Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("l5ku")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordSetChar'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSetChar</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置当前选中文本 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordSetChar(parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>parm1：字符串类型，操作对象。可设为"字体"，"字号"，"字色"，"底色"，"居中"，"靠左"，"靠右"，"加粗"，"倾斜"，"下划线"，"边框"，"缩放"，"删除线"，"上标"，"下标"，"空心"，"间距"
parm2：操作内容，不同的操作对象使用不同的内容
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>部分操作对象，当参数2设为""时有返回值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='lbji'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)

// 设置字体，参数2设为""时将返回选中文本设置的值
Call LazyOffice.WordSetChar("字体", "隶书", Index)
TracePrint LazyOffice.WordSetChar("字体", "", Index)

// 设置字号，参数2设为""时将返回选中文本设置的值。
Call LazyOffice.WordSetChar("字号", 15, Index)
TracePrint LazyOffice.WordSetChar("字号", "", Index)

// 设置字体颜色，参数2设为""时将返回选中文本设置的值。
Call LazyOffice.WordSetChar("字色", "FF00FF", Index)
TracePrint LazyOffice.WordSetChar("字色", "", Index)

// 设置字体底色，参数2设为""时将返回选中文本设置的值。
Call LazyOffice.WordSetChar("底色", 3, Index)
TracePrint LazyOffice.WordSetChar("底色", "", Index)

// 设置字形，参数2省略
Call LazyOffice.WordSetChar("加粗", "", Index)
Call LazyOffice.WordSetChar("倾斜", "", Index)

// 设置下划线，参数2为下划线颜色，设为""时清除下划线
Call LazyOffice.WordSetChar("下划线", "0000FF", Index)

// 设置删除线，参数2使用布尔型，True为添加，False为清除
Call LazyOffice.WordSetChar("删除线", True, Index)

// 设置文字缩放，参数2为1-600的整数值，设为100时是原大小
Call LazyOffice.WordSetChar("缩放", 50, Index)

// 设置文字间距，参数2为""时将返回选中文本设置的值
Call LazyOffice.WordSetChar("间距", 20, Index)
TracePrint LazyOffice.WordSetChar("间距", "", Index)

// 设置上标、下标、空心，参数2使用布尔型，True为设置，False为取消
Call LazyOffice.WordSetChar("上标", True, Index)
Call LazyOffice.WordSetChar("下标", True, Index)
Call LazyOffice.WordSetChar("空心", True, Index)

Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("lbji")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>Word文字背景颜色值对应表
1 000000 
2 FF0000 
3 FFFF00 
4 00FF00 
5 FF00FF  
6 0000FF  
7 00FFFF  
8 FFFFFF  
9 800000  
10 808000  
11 008000  
12 800080  
13 000080  
14 008080  
15 808080  
16 C0C0C0 </pre></td>
</tr></table>





<table class='help' id='WordSetCursor'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSetCursor</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>移动光标位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordSetCursor(unit[, step, dir, shift, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>unit：移动单位，可设为"段"、"字"、"行"，或直接设置非负整数值指定移动到第几个字符位置
step：整型类型，移动数量，一般设置正整数；设为0时移动到全文或者本段开头，设为-1移动到全文或者本段结尾
dir：字符串类型，移动方向，可填"上"、"下"、"左"、"右"
shift：整型类型，设置移动时是否按下Shift,0为不按，1为按下。默认为0
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>返回移动后光标的起始位置

</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='a3ts'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
// 选中从当前位置开始的5个字符
TracePrint LazyOffice.WordSetCursor("字", 5, 0, 1, Index)
// 移动到第5个字符
TracePrint LazyOffice.WordSetCursor(5, 0, 0, 0,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("a3ts")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordSetPage'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSetPage</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>页面设置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordSetPage(parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>parm1：字符串类型，操作对象。可设为"方向"，"左边距"，"右边距"，"上边距"，"下边距"，"页眉边距"，"页脚边距"，"页眉"，"页脚"，"纸张大小"
parm2：操作内容，不同的操作对象使用不同的内容
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数2设为""时有返回值
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='wfok'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
// 设置纸张大小
// 参数2设置纸张大小，目前只支持"A4","A5","B5"。不在前面所列的纸张大小，可直接填写纸张"宽*高"格式尺寸。参数2设为""时获取目前所用纸张"宽*高"格式尺寸,单位：厘米
Call LazyOffice.WordSetPage("纸张大小", "A4", Index)
TracePrint LazyOffice.WordSetPage("纸张大小", "", Index)

// 设置页脚边距，参数2设置边距值，单位：厘米，设为""时返回设置值。
Call LazyOffice.WordSetPage("页脚边距", 1.4, Index)
TracePrint LazyOffice.WordSetPage("页脚边距", "", Index)

// 设置页脚，参数2为要设置的页脚内容，设为""时返回文档页脚。
Call LazyOffice.WordSetPage("页脚", "测试写入页脚", Index)
TracePrint LazyOffice.WordSetPage("页脚", "", Index)

// 设置页眉边距，参数2设置边距值，单位：厘米，设为""时返回设置值。
Call LazyOffice.WordSetPage("页眉边距", 1.4, Index)
TracePrint LazyOffice.WordSetPage("页眉边距", "", Index)

// 设置页眉，参数2为要设置的页眉内容，设为""时返回文档页眉。
Call LazyOffice.WordSetPage("页眉", "测试写入页眉", Index)
TracePrint LazyOffice.WordSetPage("页眉", "", Index)

// 调整页边距，参数2设置边距值，单位：厘米，设为""时返回设置值。
Call LazyOffice.WordSetPage("上边距", 2.1, Index)
Call LazyOffice.WordSetPage("下边距", 1.8, Index)
Call LazyOffice.WordSetPage("左边距", 1.4, Index)
Call LazyOffice.WordSetPage("右边距", 1.5, Index)
TracePrint LazyOffice.WordSetPage("右边距", "", Index)

// 设置页面方向，参数2可设置为"横向"、"纵向"，设为""时返回设置值。
Call LazyOffice.WordSetPage("方向", "横向", Index)
TracePrint LazyOffice.WordSetPage("方向", "", Index)

Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("wfok")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordSetPara'>
<tr><th>命令名称：</th>
<td class='name'><a>WordSetPara</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置当前光标所在段落</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordSetPara(parm1[, parm2, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>parm1：字符串类型，操作对象。可设为"左缩进"，"右缩进"，"首行缩进"，"段前间距"，"段后间距"，"行距"，"对齐方式"，"大纲级别"
parm2：操作内容，不同的操作对象使用不同的内容
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='okbp'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)

// 设置缩进，参数2可设为缩进的字符数
Call LazyOffice.WordSetPara("首行缩进", 2, Index)
Call LazyOffice.WordSetPara("左缩进", 2, Index)
Call LazyOffice.WordSetPara("右缩进", 2, Index)

// 设置间距、行距，参数2设为间距行数
Call LazyOffice.WordSetPara("段前间距", 1.5, Index)
Call LazyOffice.WordSetPara("行距", 10, Index)

// 设置对齐方式，参数2可设为"居中"、"左对齐"、"右对齐"、"分散对齐"、"两端对齐"实现
Call LazyOffice.WordSetPara("对齐方式", "右对齐", Index)

// 设置大纲级别，参数2设置级别数值，大纲级别1-9级分别用数字1-9表示，正文文本级别用10表示
Call LazyOffice.WordSetPara("大纲级别", 10, Index)

Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("okbp")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordStat'>
<tr><th>命令名称：</th>
<td class='name'><a>WordStat</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取WORD文档统计信息</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordStat(tpe[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tpe：整型类型，0-6的数值，要获取的信息类型。0：字；1：行；2：页；3：字符(无空格)；4：段落；5：字符(带空格)；6：中文字符或朝鲜语单词
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>对应信息类型的统计数值

</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='u0_q'>Import "LazyOffice.dll"

Dim path, Index
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordStat(2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("u0_q")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableBorders'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableBorders</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置表格边框</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableBorders(tabid, mask[, tpe, width, color, bkgcolor, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
mask：整型类型，边框位置，"1,2,4,8,16,32”分别表示"上,下,左,右,中间横线,中间竖线”。例如，可用1+2+4+8表示区域四周边框;设为0时清除所有边框
tpe：整型类型，边框线类型，0到24的整数，默认为1
width：单位为磅，默认为1磅。具体支持的宽度可自行查看WORD中设置表格边框宽度可以选择的磅数值
color：边框线颜色，16进制颜色值，默认为"FF000000"表示使用默认颜色，填"F000000"则清除边框
bkgcolor：表格底纹颜色，16进制颜色值，默认为"FF000000"表示使用默认颜色
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='jrtt'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex= LazyOffice.WordTableInsert(3,4,3.5, Index)
Call LazyOffice.WordTableBorders(TBIndex, 1+2+4+8, 1, 3, "000000", Index)
Call LazyOffice.WordTableBorders(TBIndex, 16+32, 2, 1, "0000FF", Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("jrtt")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableCellsMerge'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableCellsMerge</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>合并表格内单元格</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableCellsMerge(tabid, srow, scolumn, erow, ecolumn[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
srow：整型类型，起始单元格行号
scolumn：整型类型，起始单元格列号
erow：整型类型，结尾单元格行号
ecolumn：整型类型，结尾单元格列号
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='yuee'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex= LazyOffice.WordTableInsert(3,4,3.5, Index)
Call LazyOffice.WordTableCellsMerge(1,1,1,1,3,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("yuee")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableCellsSplit '>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableCellsSplit </a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>表格内拆分单元格</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableCellsSplit(tabid, row, column[, rows, columns, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，单元格行号
column：整型类型，单元格列号
rows：整型类型，拆分为几行，默认为1
columns：整型类型，拆分为几列，默认为1
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='f8bx'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex= LazyOffice.WordTableInsert(3,4,3.5, Index)
Call LazyOffice.WordTableCellsSplit(1,1,1,2,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("f8bx")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableColAdd'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableColAdd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>在表格指定列号前增加一列 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableColAdd(tabid[, row, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，列号，默认为0。设为合理列号则在指定行左侧插入一列，设为0则在表格最后增加一列。
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ef0l'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
Call LazyOffice.WordTableWrite(TBIndex,1,1,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,1,2,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,1,3,"测试内容", Index)
Call LazyOffice.WordTableColAdd(TBIndex,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ef0l")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableColCount'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableColCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取表格总列数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableColCount(tabid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，总列数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='fw0n'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordTableColCount(1,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("fw0n")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableColDel'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableColDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>表格删除一列</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableColDel(tabid[, column, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
column：整型类型，列号
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='uqcr'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordTableColDel(1,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("uqcr")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableColWidth'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableColWidth</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置表格列宽</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableColWidth(tabid, column, width[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
column：整型类型，列号
width：列宽，设为0时自动调整列宽
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数3为-1时获取列宽</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='a4il'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordTableColWidth(1,2,-1,Index)
Call LazyOffice.WordTableColWidth(1,2,4.5,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("a4il")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableDel'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>删除文档中表格</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableDel(tabid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值。设为0时删除所有表格。
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='guqm'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordTableDel(1,Index)
Call LazyOffice.WordClose(Index)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("guqm")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableInsert'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableInsert</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>当前位置插入表格 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableInsert(row, column[, width, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>row：整型类型，表格行数
column：整型类型，表格列数
width：表格列宽类型。-2为根据窗口调整，-1根据内容调整，非负数为固定列宽并使用此参数作为列宽
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，表格索引值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='hcri'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex= LazyOffice.WordTableInsert(3,4,3.5, Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("hcri")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableLoc'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableLoc</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取表格位置</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableLoc(tabid[,idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，表格起始位置
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ffct'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
TracePrint LazyOffice.WordTableLoc(TBIndex, Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ffct")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableRead'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableRead</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>读取表格内值</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableRead(tabid, row, column[,idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，行号
column：整型类型，列号
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>字符串类型，值
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='jtit'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
TracePrint LazyOffice.WordTableRead(TBIndex,1,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("jtit")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableRowAdd'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableRowAdd</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>在表格指定行号前增加一行</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableRowAdd(tabid[, row, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，行号，默认为0。设为合理行号则在指定行上方插入一行，设为0则在表格最后增加一行
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无
</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='j97n'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
Call LazyOffice.WordTableWrite(TBIndex,1,1,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,2,1,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,3,1,"测试内容", Index)
Call LazyOffice.WordTableRowAdd(TBIndex,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("j97n")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableRowCount'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableRowCount</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取表格总行数</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableRowCount(tabid[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>整型类型，总行数</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='rrhd'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TracePrint LazyOffice.WordTableRowCount(1,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("rrhd")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableRowDel'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableRowDel</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>表格删除一行</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableRowDel(tabid[, row, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，行号
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ht2n'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordTableRowDel(1,2,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ht2n")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableRowHight'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableRowHight</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置表格列宽</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableRowHight(tabid, column, hight[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
column：整型类型，行号
hight：行高
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='ypzh'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
TracePrint LazyOffice.WordTableRowHight(1,2,-1,Index)
Call LazyOffice.WordTableRowHight(1,2,4.5,Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("ypzh")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableSelected'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableSelected</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>获取当前选中表格的索引值 </pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableSelected([idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>选中内容中无表格时返回0，选中内容中有表格时返回各个表的索引值，用","隔开，需要使用时通过Cint转换为整型</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='feob'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
TracePrint LazyOffice.WordTableSelected(Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("feob")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordTableSet'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableSet</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>设置表格</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Function WordTableSet(tabid, parm1, parm2[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
parm1：字符串类型，可用对象包括"水平对齐"，"垂直对齐"，"左边距"，"右边距"，"上边距"，"下边距"，"表格转文本"，"文本转表格"，"选中全表"，"选中单元格"
parm2：操作内容，不同的操作对象使用不同的内容
idx：整型类型，WORD索引值</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>参数3为""时返回对应对象的值</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='mwoe'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
// 设置对齐方式
TracePrint LazyOffice.WordTableSet(TBIndex,"水平对齐","", Index)
Call LazyOffice.WordTableSet(TBIndex,"水平对齐","居中", Index)
Call LazyOffice.WordTableSet(TBIndex, "垂直对齐", "居中", Index)

// 设置单元格边距
TracePrint LazyOffice.WordTableSet(TBIndex,"左边距","", Index)
Call LazyOffice.WordTableSet(TBIndex,"左边距",0.2, Index)
Call LazyOffice.WordTableSet(TBIndex,"右边距",0.3, Index)
Call LazyOffice.WordTableSet(TBIndex,"上边距",0.4, Index)
Call LazyOffice.WordTableSet(TBIndex,"下边距",0.5, Index)

// 表格转文本
Call LazyOffice.WordTableWrite(TBIndex,1,1,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,1,2,"测试内容", Index)
Call LazyOffice.WordTableWrite(TBIndex,2,2,"测试内容", Index)
Call LazyOffice.WordTableSet(TBIndex,"表格转文本","|", Index)

// 文本转表格
Call LazyOffice.WordWriteEX("测|试|文" & "\n" & "本||转" & "\n" & "|表|格", Index)
Call LazyOffice.WordSetCursor("段",-1,0,1,Index)
TBIndex = LazyOffice.WordTableSet(0,"文本转表格","|", Index)

Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("mwoe")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>参数2填写"水平对齐"时，参数3可使用"居中"、"靠右"、"靠左"进行设置。参数3填""时返回当前设置，返回值为整型值，分别用1、2、3表示"居中"、"靠右"、"靠左"。
  参数2填写"垂直对齐"时，参数3可使用"居中"、"靠下"、"靠上"进行设置。参数3填""时返回当前设置，返回值为整型值，分别用1、0、3表示"居中"、"靠下"、"靠上"。
参数2填写"左边距"、"右边距"、"上边距"、"下边距"时，参数3可使用厘米单位的数值来设置单元格边距。参数3填""时返回当前设置。
参数2填写"表格转文本"时，参数3设置转为文本时的分隔符。
</pre></td>
</tr></table>





<table class='help' id='WordTableWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>WordTableWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>表格内写入值</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordTableWrite(tabid, row, column, value[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>tabid：整型类型，表格索引值
row：整型类型，行号
column：整型类型，列号
value：值
idx：整型类型，WORD索引值


</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='dzji'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
TBIndex = LazyOffice.WordTableInsert(3, 4, 3.5, Index)
Call LazyOffice.WordTableWrite(TBIndex,1,2,"测试内容", Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("dzji")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordWrite'>
<tr><th>命令名称：</th>
<td class='name'><a>WordWrite</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>从当前位置写入内容</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordWrite(value[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>value：字符串型，内容
idx：整型类型，WORD索引值


</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='b36b'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordSetCursor("字",2,"右",1,index)
Call LazyOffice.WordWrite("测试插入内容",Index)
Call LazyOffice.WordClose(Index)
</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("b36b")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordWriteEX'>
<tr><th>命令名称：</th>
<td class='name'><a>WordWriteEX</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>重写Word文档，替换原有内容</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordWriteEX(value[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>value：字符串型，内容
idx：整型类型，WORD索引值


</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='htev'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordWriteEX("测试重写内容",Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("htev")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>





<table class='help' id='WordWriteLink'>
<tr><th>命令名称：</th>
<td class='name'><a>WordWriteLink</a></td>
</tr><tr><th>命令功能：</th>
<td class='readme'><pre>当前选中文字添加超链接</pre></td>
</tr><tr><th>语法格式：</th>
<td class='define'><pre>Sub WordWriteLink(link[, idx])</pre></td>
</tr><tr><th>参数说明：</th>
<td class='param'><pre>link：字符串类型，链接地址，当设为""时清除选中文字中所有链接
idx：整型类型，WORD索引值


</pre></td>
</tr><tr><th>返回值：</th>
<td class='return'><pre>无</pre></td>
</tr><tr><th><span class='red'>脚本例子：</span></th>
<td class='example'><pre class='prettyprint lang-ql linenums' id='pbfr'>Import "LazyOffice.dll"

Dim path, Index, TBIndex
path = "C:\\测试.doc"
Index = LazyOffice.WordOpen(path, 0)
Call LazyOffice.WordSetCursor("字",2,"右",1,index)
Call LazyOffice.WordWriteLink("http://www.baidu.com", Index)
Call LazyOffice.WordClose(Index)</pre>
<pre><a class='copy' href='javascript:void(0)' onclick='copycode("pbfr")'>点击复制代码</a></pre>
</td></tr><tr><th>备注：</th>
<td class='note'><pre>无</pre></td>
</tr></table>




</body>
</html>